Object.defineProperty(exports, "__esModule", { value: true });
const iterable_1 = require("../iterable");
class FinalyIterable extends iterable_1.IterableX {
    constructor(source, action) {
        super();
        this._source = source;
        this._action = action;
    }
    *[Symbol.iterator]() {
        try {
            yield* this._source;
        }
        finally {
            this._action();
        }
    }
}
/**
 * Creates a sequence whose termination or disposal of an iterator causes a finally action to be executed.
 * @param {Iterator<T>} source Source sequence
 * @param {function(): void)} action Action to run upon termination of the sequence, or when an iterator is disposed.
 * @return {Iterable<T>} Source sequence with guarantees on the invocation of the finally action.
 */
function _finally(source, action) {
    return new FinalyIterable(source, action);
}
exports._finally = _finally;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIml0ZXJhYmxlL2ZpbmFsbHkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLDBDQUF3QztBQUV4QyxvQkFBOEIsU0FBUSxvQkFBa0I7SUFJdEQsWUFBWSxNQUF5QixFQUFFLE1BQWtCO1FBQ3ZELEtBQUssRUFBRSxDQUFDO1FBQ1IsSUFBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7UUFDdEIsSUFBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7SUFDeEIsQ0FBQztJQUVELENBQUMsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDO1FBQ2hCLElBQUksQ0FBQztZQUNILE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQztRQUN0QixDQUFDO2dCQUFTLENBQUM7WUFDVCxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDakIsQ0FBQztJQUNILENBQUM7Q0FDRjtBQUVEOzs7OztHQUtHO0FBQ0gsa0JBQ0ksTUFBeUIsRUFDekIsTUFBa0I7SUFDcEIsTUFBTSxDQUFDLElBQUksY0FBYyxDQUFVLE1BQU0sRUFBRSxNQUFNLENBQUMsQ0FBQztBQUNyRCxDQUFDO0FBSkQsNEJBSUMiLCJmaWxlIjoiaXRlcmFibGUvZmluYWxseS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEl0ZXJhYmxlWCB9IGZyb20gJy4uL2l0ZXJhYmxlJztcblxuY2xhc3MgRmluYWx5SXRlcmFibGU8VFNvdXJjZT4gZXh0ZW5kcyBJdGVyYWJsZVg8VFNvdXJjZT4ge1xuICBwcml2YXRlIF9zb3VyY2U6IEl0ZXJhYmxlPFRTb3VyY2U+O1xuICBwcml2YXRlIF9hY3Rpb246ICgpID0+IHZvaWQ7XG5cbiAgY29uc3RydWN0b3Ioc291cmNlOiBJdGVyYWJsZTxUU291cmNlPiwgYWN0aW9uOiAoKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9zb3VyY2UgPSBzb3VyY2U7XG4gICAgdGhpcy5fYWN0aW9uID0gYWN0aW9uO1xuICB9XG5cbiAgKltTeW1ib2wuaXRlcmF0b3JdKCkge1xuICAgIHRyeSB7XG4gICAgICB5aWVsZCogdGhpcy5fc291cmNlO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0aGlzLl9hY3Rpb24oKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgc2VxdWVuY2Ugd2hvc2UgdGVybWluYXRpb24gb3IgZGlzcG9zYWwgb2YgYW4gaXRlcmF0b3IgY2F1c2VzIGEgZmluYWxseSBhY3Rpb24gdG8gYmUgZXhlY3V0ZWQuXG4gKiBAcGFyYW0ge0l0ZXJhdG9yPFQ+fSBzb3VyY2UgU291cmNlIHNlcXVlbmNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKCk6IHZvaWQpfSBhY3Rpb24gQWN0aW9uIHRvIHJ1biB1cG9uIHRlcm1pbmF0aW9uIG9mIHRoZSBzZXF1ZW5jZSwgb3Igd2hlbiBhbiBpdGVyYXRvciBpcyBkaXNwb3NlZC5cbiAqIEByZXR1cm4ge0l0ZXJhYmxlPFQ+fSBTb3VyY2Ugc2VxdWVuY2Ugd2l0aCBndWFyYW50ZWVzIG9uIHRoZSBpbnZvY2F0aW9uIG9mIHRoZSBmaW5hbGx5IGFjdGlvbi5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9maW5hbGx5PFRTb3VyY2U+KFxuICAgIHNvdXJjZTogSXRlcmFibGU8VFNvdXJjZT4sXG4gICAgYWN0aW9uOiAoKSA9PiB2b2lkKTogSXRlcmFibGVYPFRTb3VyY2U+IHtcbiAgcmV0dXJuIG5ldyBGaW5hbHlJdGVyYWJsZTxUU291cmNlPihzb3VyY2UsIGFjdGlvbik7XG59XG4iXX0=
