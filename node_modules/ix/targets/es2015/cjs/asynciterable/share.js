Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const asynciterable_1 = require("../asynciterable");
const create_1 = require("./create");
class SharedAsyncIterable extends asynciterable_1.AsyncIterableX {
    constructor(it) {
        super();
        this._it = it;
    }
    [Symbol.asyncIterator]() {
        return this._it;
    }
}
function share(source, selector) {
    return selector ?
        create_1.create(() => tslib_1.__awaiter(this, void 0, void 0, function* () {
            const it = yield selector(new SharedAsyncIterable(source[Symbol.asyncIterator]()));
            return it[Symbol.asyncIterator]();
        })) :
        new SharedAsyncIterable(source[Symbol.asyncIterator]());
}
exports.share = share;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzeW5jaXRlcmFibGUvc2hhcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxvREFBa0Q7QUFDbEQscUNBQWtDO0FBRWxDLHlCQUE2QixTQUFRLDhCQUFpQjtJQUdwRCxZQUFZLEVBQW9CO1FBQzlCLEtBQUssRUFBRSxDQUFDO1FBQ1IsSUFBSSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUM7SUFDaEIsQ0FBQztJQUVELENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQztRQUNwQixNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQztJQUNsQixDQUFDO0NBQ0Y7QUFRRCxlQUNJLE1BQThCLEVBQzlCLFFBQXNHO0lBRXhHLE1BQU0sQ0FBQyxRQUFRO1FBQ2IsZUFBTSxDQUNKO1lBQ0UsTUFBTSxFQUFFLEdBQUcsTUFBTSxRQUFRLENBQUMsSUFBSSxtQkFBbUIsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ25GLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUM7UUFDbkMsQ0FBQyxDQUFBLENBQUM7UUFDTCxJQUFJLG1CQUFtQixDQUFVLE1BQU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBQ3JFLENBQUM7QUFYRCxzQkFXQyIsImZpbGUiOiJhc3luY2l0ZXJhYmxlL3NoYXJlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXN5bmNJdGVyYWJsZVggfSBmcm9tICcuLi9hc3luY2l0ZXJhYmxlJztcbmltcG9ydCB7IGNyZWF0ZSB9IGZyb20gJy4vY3JlYXRlJztcblxuY2xhc3MgU2hhcmVkQXN5bmNJdGVyYWJsZTxUPiBleHRlbmRzIEFzeW5jSXRlcmFibGVYPFQ+IHtcbiAgcHJpdmF0ZSBfaXQ6IEFzeW5jSXRlcmF0b3I8VD47XG5cbiAgY29uc3RydWN0b3IoaXQ6IEFzeW5jSXRlcmF0b3I8VD4pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX2l0ID0gaXQ7XG4gIH1cblxuICBbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkge1xuICAgIHJldHVybiB0aGlzLl9pdDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2hhcmU8VFNvdXJjZT4oXG4gICAgc291cmNlOiBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+KTogQXN5bmNJdGVyYWJsZVg8VFNvdXJjZT47XG5leHBvcnQgZnVuY3Rpb24gc2hhcmU8VFNvdXJjZSwgVFJlc3VsdD4oXG4gICAgc291cmNlOiBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+LFxuICAgIHNlbGVjdG9yPzogKHZhbHVlOiBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+KSA9PiBBc3luY0l0ZXJhYmxlPFRSZXN1bHQ+IHwgUHJvbWlzZTxBc3luY0l0ZXJhYmxlPFRSZXN1bHQ+Pik6XG4gICAgICBBc3luY0l0ZXJhYmxlWDxUUmVzdWx0PjtcbmV4cG9ydCBmdW5jdGlvbiBzaGFyZTxUU291cmNlLCBUUmVzdWx0ID0gVFNvdXJjZT4oXG4gICAgc291cmNlOiBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+LFxuICAgIHNlbGVjdG9yPzogKHZhbHVlOiBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+KSA9PiBBc3luY0l0ZXJhYmxlPFRSZXN1bHQ+IHwgUHJvbWlzZTxBc3luY0l0ZXJhYmxlPFRSZXN1bHQ+Pik6XG4gICAgICBBc3luY0l0ZXJhYmxlWDxUU291cmNlIHwgVFJlc3VsdD4ge1xuICByZXR1cm4gc2VsZWN0b3IgP1xuICAgIGNyZWF0ZTxUUmVzdWx0PihcbiAgICAgIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgaXQgPSBhd2FpdCBzZWxlY3RvcihuZXcgU2hhcmVkQXN5bmNJdGVyYWJsZShzb3VyY2VbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkpKTtcbiAgICAgICAgcmV0dXJuIGl0W1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpO1xuICAgICAgIH0pIDpcbiAgICBuZXcgU2hhcmVkQXN5bmNJdGVyYWJsZTxUU291cmNlPihzb3VyY2VbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkpO1xufVxuIl19
