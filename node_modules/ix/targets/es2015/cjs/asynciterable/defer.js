Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const asynciterable_1 = require("../asynciterable");
class DeferAsyncIterable extends asynciterable_1.AsyncIterableX {
    constructor(fn) {
        super();
        this._fn = fn;
    }
    [Symbol.asyncIterator]() {
        return tslib_1.__asyncGenerator(this, arguments, function* _a() {
            let items = yield tslib_1.__await(this._fn());
            try {
                for (var items_1 = tslib_1.__asyncValues(items), items_1_1; items_1_1 = yield tslib_1.__await(items_1.next()), !items_1_1.done;) {
                    let item = yield tslib_1.__await(items_1_1.value);
                    yield item;
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (items_1_1 && !items_1_1.done && (_a = items_1.return)) yield tslib_1.__await(_a.call(items_1));
                }
                finally { if (e_1) throw e_1.error; }
            }
            var e_1, _a;
        });
    }
}
function defer(factory) {
    return new DeferAsyncIterable(factory);
}
exports.defer = defer;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzeW5jaXRlcmFibGUvZGVmZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxvREFBa0Q7QUFFbEQsd0JBQWtDLFNBQVEsOEJBQXVCO0lBRy9ELFlBQVksRUFBa0U7UUFDNUUsS0FBSyxFQUFFLENBQUM7UUFDUixJQUFJLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQztJQUNoQixDQUFDO0lBRU0sQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDOztZQUMzQixJQUFJLEtBQUssR0FBRyxzQkFBTSxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUEsQ0FBQzs7Z0JBQzdCLEdBQUcsQ0FBQyxDQUFtQixJQUFBLFVBQUEsc0JBQUEsS0FBSyxDQUFBLFdBQUE7b0JBQWpCLElBQUksSUFBSSx5Q0FBQSxDQUFBO29CQUFhLE1BQU0sSUFBSSxDQUFDO2lCQUFFOzs7Ozs7Ozs7O1FBQy9DLENBQUM7S0FBQTtDQUNGO0FBRUQsZUFDSSxPQUF1RTtJQUN6RSxNQUFNLENBQUMsSUFBSSxrQkFBa0IsQ0FBVSxPQUFPLENBQUMsQ0FBQztBQUNsRCxDQUFDO0FBSEQsc0JBR0MiLCJmaWxlIjoiYXN5bmNpdGVyYWJsZS9kZWZlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzeW5jSXRlcmFibGVYIH0gZnJvbSAnLi4vYXN5bmNpdGVyYWJsZSc7XG5cbmNsYXNzIERlZmVyQXN5bmNJdGVyYWJsZTxUU291cmNlPiBleHRlbmRzIEFzeW5jSXRlcmFibGVYPFRTb3VyY2U+IHtcbiAgcHJpdmF0ZSBfZm46ICgpID0+IEFzeW5jSXRlcmFibGU8VFNvdXJjZT4gfCBQcm9taXNlPEFzeW5jSXRlcmFibGU8VFNvdXJjZT4+O1xuXG4gIGNvbnN0cnVjdG9yKGZuOiAoKSA9PiBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+IHwgUHJvbWlzZTxBc3luY0l0ZXJhYmxlPFRTb3VyY2U+Pikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fZm4gPSBmbjtcbiAgfVxuXG4gIGFzeW5jICpbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkge1xuICAgIGxldCBpdGVtcyA9IGF3YWl0IHRoaXMuX2ZuKCk7XG4gICAgZm9yIGF3YWl0IChsZXQgaXRlbSBvZiBpdGVtcykgeyB5aWVsZCBpdGVtOyB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlZmVyPFRTb3VyY2U+KFxuICAgIGZhY3Rvcnk6ICgpID0+IEFzeW5jSXRlcmFibGU8VFNvdXJjZT4gfCBQcm9taXNlPEFzeW5jSXRlcmFibGU8VFNvdXJjZT4+KTogQXN5bmNJdGVyYWJsZVg8VFNvdXJjZT4ge1xuICByZXR1cm4gbmV3IERlZmVyQXN5bmNJdGVyYWJsZTxUU291cmNlPihmYWN0b3J5KTtcbn1cbiJdfQ==
