import { AsyncIterableX } from '../asynciterable';
import { create } from './create';
class SharedAsyncIterable extends AsyncIterableX {
    constructor(it) {
        super();
        this._it = it;
    }
    [Symbol.asyncIterator]() {
        return this._it;
    }
}
export function share(source, selector) {
    return selector ?
        create(async () => {
            const it = await selector(new SharedAsyncIterable(source[Symbol.asyncIterator]()));
            return it[Symbol.asyncIterator]();
        }) :
        new SharedAsyncIterable(source[Symbol.asyncIterator]());
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzeW5jaXRlcmFibGUvc2hhcmUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQ2xELE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxVQUFVLENBQUM7QUFFbEMseUJBQTZCLFNBQVEsY0FBaUI7SUFHcEQsWUFBWSxFQUFvQjtRQUM5QixLQUFLLEVBQUUsQ0FBQztRQUNSLElBQUksQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDO0lBQ2hCLENBQUM7SUFFRCxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUM7UUFDcEIsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7SUFDbEIsQ0FBQztDQUNGO0FBUUQsTUFBTSxnQkFDRixNQUE4QixFQUM5QixRQUFzRztJQUV4RyxNQUFNLENBQUMsUUFBUTtRQUNiLE1BQU0sQ0FDSixLQUFLO1lBQ0gsTUFBTSxFQUFFLEdBQUcsTUFBTSxRQUFRLENBQUMsSUFBSSxtQkFBbUIsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ25GLE1BQU0sQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUM7UUFDbkMsQ0FBQyxDQUFDO1FBQ0wsSUFBSSxtQkFBbUIsQ0FBVSxNQUFNLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUMsQ0FBQztBQUNyRSxDQUFDIiwiZmlsZSI6ImFzeW5jaXRlcmFibGUvc2hhcmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBc3luY0l0ZXJhYmxlWCB9IGZyb20gJy4uL2FzeW5jaXRlcmFibGUnO1xuaW1wb3J0IHsgY3JlYXRlIH0gZnJvbSAnLi9jcmVhdGUnO1xuXG5jbGFzcyBTaGFyZWRBc3luY0l0ZXJhYmxlPFQ+IGV4dGVuZHMgQXN5bmNJdGVyYWJsZVg8VD4ge1xuICBwcml2YXRlIF9pdDogQXN5bmNJdGVyYXRvcjxUPjtcblxuICBjb25zdHJ1Y3RvcihpdDogQXN5bmNJdGVyYXRvcjxUPikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5faXQgPSBpdDtcbiAgfVxuXG4gIFtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKSB7XG4gICAgcmV0dXJuIHRoaXMuX2l0O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaGFyZTxUU291cmNlPihcbiAgICBzb3VyY2U6IEFzeW5jSXRlcmFibGU8VFNvdXJjZT4pOiBBc3luY0l0ZXJhYmxlWDxUU291cmNlPjtcbmV4cG9ydCBmdW5jdGlvbiBzaGFyZTxUU291cmNlLCBUUmVzdWx0PihcbiAgICBzb3VyY2U6IEFzeW5jSXRlcmFibGU8VFNvdXJjZT4sXG4gICAgc2VsZWN0b3I/OiAodmFsdWU6IEFzeW5jSXRlcmFibGU8VFNvdXJjZT4pID0+IEFzeW5jSXRlcmFibGU8VFJlc3VsdD4gfCBQcm9taXNlPEFzeW5jSXRlcmFibGU8VFJlc3VsdD4+KTpcbiAgICAgIEFzeW5jSXRlcmFibGVYPFRSZXN1bHQ+O1xuZXhwb3J0IGZ1bmN0aW9uIHNoYXJlPFRTb3VyY2UsIFRSZXN1bHQgPSBUU291cmNlPihcbiAgICBzb3VyY2U6IEFzeW5jSXRlcmFibGU8VFNvdXJjZT4sXG4gICAgc2VsZWN0b3I/OiAodmFsdWU6IEFzeW5jSXRlcmFibGU8VFNvdXJjZT4pID0+IEFzeW5jSXRlcmFibGU8VFJlc3VsdD4gfCBQcm9taXNlPEFzeW5jSXRlcmFibGU8VFJlc3VsdD4+KTpcbiAgICAgIEFzeW5jSXRlcmFibGVYPFRTb3VyY2UgfCBUUmVzdWx0PiB7XG4gIHJldHVybiBzZWxlY3RvciA/XG4gICAgY3JlYXRlPFRSZXN1bHQ+KFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBpdCA9IGF3YWl0IHNlbGVjdG9yKG5ldyBTaGFyZWRBc3luY0l0ZXJhYmxlKHNvdXJjZVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKSkpO1xuICAgICAgICByZXR1cm4gaXRbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCk7XG4gICAgICAgfSkgOlxuICAgIG5ldyBTaGFyZWRBc3luY0l0ZXJhYmxlPFRTb3VyY2U+KHNvdXJjZVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKSk7XG59XG4iXX0=
