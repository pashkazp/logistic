goog.module('targets.esnext.cls.asynciterable.reduce'); exports = {}; var module = {id: 'targets/esnext/cls/asynciterable/reduce.js'};/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @template T, R
 * @param {!AsyncIterable<T>} source
 * @param {function((T|R), T, number): (R|!Promise<R>)} accumulator
 * @param {...(T|R)} args
 * @return {!Promise<(T|R)>}
 */
async function reduce(source, accumulator, ...args) {
    let [seed] = args;
    const /** @type {boolean} */ hasSeed = args.length === 1;
    let /** @type {number} */ i = 0, /** @type {boolean} */ hasValue = false;
    for await (let /** @type {T} */ item of source) {
        if (hasValue || (hasValue = hasSeed)) {
            seed = await accumulator(seed, item, i++);
        }
        else {
            seed = item;
            hasValue = true;
            i++;
        }
    }
    if (hasSeed && !hasValue) {
        return ((seed));
    }
    if (!hasValue) {
        throw new Error('Sequence contains no elements');
    }
    return ((seed));
}
exports.reduce = reduce;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9hc3luY2l0ZXJhYmxlL3JlZHVjZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0dBR0c7O0FBU0g7Ozs7OztHQU1HO0FBWEcsS0FBTSxpQkFhUixNQVp3QixFQWF4QixXQVpvRSxFQWFwRSxHQVpHLElBQWU7SUFhcEIsSUFaRyxDQUFFLElBQUksQ0FBQyxHQUFFLElBQUssQ0FBQztJQWFsQixNQUFNLHNCQVpELENBQUEsT0FBUSxHQUFFLElBQUssQ0FBQyxNQUFNLEtBQUksQ0FBRSxDQUFDO0lBYWxDLElBQUkscUJBWkQsQ0FBQSxDQUFFLEdBQUUsQ0FBRSxFQUFBLHNCQUFDLENBQUEsUUFBUyxHQUFFLEtBQU0sQ0FBQztJQWE1QixHQVpHLENBQUEsS0FBTSxDQUFOLENBQVEsSUFBQSxnQkFBRyxDQUFBLElBQUssSUFBRyxNQUFPLENBQUMsQ0FBQSxDQUFFO1FBYTlCLEVBQUUsQ0FBQyxDQVpDLFFBQVEsSUFBRyxDQUFFLFFBQVEsR0FBRSxPQUFRLENBQUMsQ0FBQyxDQUFBLENBQUU7WUFhckMsSUFaSSxHQUFFLE1BQU0sV0FBWSxDQUFDLElBQUksRUFBQyxJQUFLLEVBQUMsQ0FBRSxFQUFFLENBQUMsQ0FBQztRQWE1QyxDQVpDO1FBQUEsSUFBSyxDQUFBLENBQUU7WUFhTixJQVpJLEdBQUUsSUFBSyxDQUFDO1lBYVosUUFaUSxHQUFFLElBQUssQ0FBQztZQWFoQixDQVpDLEVBQUUsQ0FBQztRQWFOLENBWkM7SUFhSCxDQVpDO0lBY0QsRUFBRSxDQUFDLENBWkMsT0FBTyxJQUFHLENBQUUsUUFBUSxDQUFDLENBQUEsQ0FBRTtRQWF6QixNQUFNLENBQXFCLENBQUMsQ0FadEIsSUFBQSxDQUFBLENBQU0sQ0FBQztJQWFmLENBWkM7SUFjRCxFQUFFLENBQUMsQ0FaQyxDQUFDLFFBQVEsQ0FBQyxDQUFBLENBQUU7UUFhZCxNQVpLLElBQUksS0FBTSxDQUFDLCtCQUErQixDQUFDLENBQUM7SUFhbkQsQ0FaQztJQWNELE1BQU0sQ0FBcUIsQ0FBQyxDQVp0QixJQUFBLENBQUEsQ0FBTSxDQUFDO0FBYWYsQ0FaQztBQTFCRCx3QkEwQkMiLCJmaWxlIjoicmVkdWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGZpbGVvdmVydmlldyBhZGRlZCBieSB0c2lja2xlXG4gKiBAc3VwcHJlc3Mge2NoZWNrVHlwZXN9IGNoZWNrZWQgYnkgdHNjXG4gKi9cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZHVjZTxUPihcbiAgc291cmNlOiBBc3luY0l0ZXJhYmxlPFQ+LFxuICBhY2N1bXVsYXRvcjogKGFjYzogVCwgdmFsdWU6IFQsIGluZGV4OiBudW1iZXIpID0+IFQgfCBQcm9taXNlPFQ+KTogUHJvbWlzZTxUPjtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWR1Y2U8VCwgUiA9IFQ+KFxuICBzb3VyY2U6IEFzeW5jSXRlcmFibGU8VD4sXG4gIGFjY3VtdWxhdG9yOiAoYWNjOiBSLCB2YWx1ZTogVCwgaW5kZXg6IG51bWJlcikgPT4gUiB8IFByb21pc2U8Uj4sXG4gIHNlZWQ6IFIpOiBQcm9taXNlPFI+O1xuLyoqXG4gKiBAdGVtcGxhdGUgVCwgUlxuICogQHBhcmFtIHshQXN5bmNJdGVyYWJsZTxUPn0gc291cmNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKChUfFIpLCBULCBudW1iZXIpOiAoUnwhUHJvbWlzZTxSPil9IGFjY3VtdWxhdG9yXG4gKiBAcGFyYW0gey4uLihUfFIpfSBhcmdzXG4gKiBAcmV0dXJuIHshUHJvbWlzZTwoVHxSKT59XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZWR1Y2U8VCwgUiA9IFQ+KFxuICAgIHNvdXJjZTogQXN5bmNJdGVyYWJsZTxUPixcbiAgICBhY2N1bXVsYXRvcjogKGFjYzogVCB8IFIsIHZhbHVlOiBULCBpbmRleDogbnVtYmVyKSA9PiBSIHwgUHJvbWlzZTxSPixcbiAgICAuLi5hcmdzOiAoVCB8IFIpW10pOiBQcm9taXNlPFQgfCBSPiB7XG4gIGxldCBbc2VlZF0gPSBhcmdzO1xuICBjb25zdCAvKiogQHR5cGUge2Jvb2xlYW59ICovIGhhc1NlZWQgPSBhcmdzLmxlbmd0aCA9PT0gMTtcbiAgbGV0IC8qKiBAdHlwZSB7bnVtYmVyfSAqLyBpID0gMCwgLyoqIEB0eXBlIHtib29sZWFufSAqLyBoYXNWYWx1ZSA9IGZhbHNlO1xuICBmb3IgYXdhaXQgKGxldCAvKiogQHR5cGUge1R9ICovIGl0ZW0gb2Ygc291cmNlKSB7XG4gICAgaWYgKGhhc1ZhbHVlIHx8IChoYXNWYWx1ZSA9IGhhc1NlZWQpKSB7XG4gICAgICBzZWVkID0gYXdhaXQgYWNjdW11bGF0b3Ioc2VlZCwgaXRlbSwgaSsrKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VlZCA9IGl0ZW07XG4gICAgICBoYXNWYWx1ZSA9IHRydWU7XG4gICAgICBpKys7XG4gICAgfVxuICB9XG5cbiAgaWYgKGhhc1NlZWQgJiYgIWhhc1ZhbHVlKSB7XG4gICAgcmV0dXJuIC8qKiBAdHlwZSB7KFR8Uil9ICovKCggc2VlZCkpO1xuICB9XG5cbiAgaWYgKCFoYXNWYWx1ZSkge1xuICAgIHRocm93IG5ldyBFcnJvcignU2VxdWVuY2UgY29udGFpbnMgbm8gZWxlbWVudHMnKTtcbiAgfVxuXG4gIHJldHVybiAvKiogQHR5cGUgeyhUfFIpfSAqLygoIHNlZWQpKTtcbn1cbiJdfQ==