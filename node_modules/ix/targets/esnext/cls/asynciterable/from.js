goog.module('targets.esnext.cls.asynciterable.from'); exports = {}; var module = {id: 'targets/esnext/cls/asynciterable/from.js'};/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

var asynciterable_1 = goog.require('targets.esnext.cls.asynciterable');
const tsickle_forward_declare_1 = goog.forwardDeclare("_Users.ptaylor.dev.ixjs.src.asynciterable");
var bindcallback_1 = goog.require('targets.esnext.cls.internal.bindcallback');
const tsickle_forward_declare_2 = goog.forwardDeclare("_Users.ptaylor.dev.ixjs.src.internal.bindcallback");
var identity_1 = goog.require('targets.esnext.cls.internal.identity');
const tsickle_forward_declare_3 = goog.forwardDeclare("_Users.ptaylor.dev.ixjs.src.internal.identity");
var tolength_1 = goog.require('targets.esnext.cls.internal.tolength');
const tsickle_forward_declare_4 = goog.forwardDeclare("_Users.ptaylor.dev.ixjs.src.internal.tolength");
var isiterable_1 = goog.require('targets.esnext.cls.internal.isiterable');
const tsickle_forward_declare_5 = goog.forwardDeclare("_Users.ptaylor.dev.ixjs.src.internal.isiterable");
const tsickle_forward_declare_6 = goog.forwardDeclare("_Users.ptaylor.dev.ixjs.src.observer");
goog.require("_Users.ptaylor.dev.ixjs.src.observer"); // force type-only module to be loaded
/**
 * @template TSource, TResult
 */
class FromArrayIterable extends asynciterable_1.AsyncIterableX {
    /**
     * @param {!ArrayLike<TSource>} source
     * @param {function(TSource, number): (TResult|!Promise<TResult>)} selector
     */
    constructor(source, selector) {
        super();
        this._source = source;
        this._selector = selector;
    }
    /**
     * @return {!AsyncIterableIterator<TResult>}
     */
    async *[Symbol.asyncIterator]() {
        let /** @type {number} */ i = 0;
        const /** @type {number} */ length = tolength_1.toLength(((this._source)).length);
        while (i < length) {
            yield await this._selector(this._source[i], i++);
        }
    }
}
function FromArrayIterable_tsickle_Closure_declarations() {
    /** @type {!ArrayLike<TSource>} */
    FromArrayIterable.prototype._source;
    /** @type {function(TSource, number): (TResult|!Promise<TResult>)} */
    FromArrayIterable.prototype._selector;
}
/**
 * @template TSource, TResult
 */
class FromAsyncIterable extends asynciterable_1.AsyncIterableX {
    /**
     * @param {(!Iterable<(TSource|!PromiseLike<TSource>)>|!AsyncIterable<TSource>)} source
     * @param {function(TSource, number): (TResult|!Promise<TResult>)} selector
     */
    constructor(source, selector) {
        super();
        this._source = source;
        this._selector = selector;
    }
    /**
     * @return {!AsyncIterableIterator<TResult>}
     */
    async *[Symbol.asyncIterator]() {
        let /** @type {number} */ i = 0;
        for await (let /** @type {TSource} */ item of (this._source)) {
            yield await this._selector(item, i++);
        }
    }
}
function FromAsyncIterable_tsickle_Closure_declarations() {
    /** @type {(!Iterable<(TSource|!PromiseLike<TSource>)>|!AsyncIterable<TSource>)} */
    FromAsyncIterable.prototype._source;
    /** @type {function(TSource, number): (TResult|!Promise<TResult>)} */
    FromAsyncIterable.prototype._selector;
}
/**
 * @template TSource, TResult
 */
class FromPromiseIterable extends asynciterable_1.AsyncIterableX {
    /**
     * @param {!PromiseLike<TSource>} source
     * @param {function(TSource, number): (TResult|!Promise<TResult>)} selector
     */
    constructor(source, selector) {
        super();
        this._source = source;
        this._selector = selector;
    }
    /**
     * @return {!AsyncIterableIterator<TResult>}
     */
    async *[Symbol.asyncIterator]() {
        const /** @type {TSource} */ item = await this._source;
        yield await this._selector(item, 0);
    }
}
function FromPromiseIterable_tsickle_Closure_declarations() {
    /** @type {!PromiseLike<TSource>} */
    FromPromiseIterable.prototype._source;
    /** @type {function(TSource, number): (TResult|!Promise<TResult>)} */
    FromPromiseIterable.prototype._selector;
}
/**
 * @template TSource
 */
class AsyncObserver {
    constructor() {
        this.values = [];
        this.hasCompleted = false;
        this.hasError = false;
        this.errorValue = null;
        this.closed = false;
    }
    /**
     * @param {TSource} value
     * @return {void}
     */
    next(value) {
        if (!this.closed) {
            this.values.push(value);
        }
    }
    /**
     * @param {?} err
     * @return {void}
     */
    error(err) {
        if (!this.closed) {
            this.closed = true;
            this.hasError = true;
            this.errorValue = err;
        }
    }
    /**
     * @return {void}
     */
    complete() {
        if (!this.closed) {
            this.closed = true;
        }
    }
}
function AsyncObserver_tsickle_Closure_declarations() {
    /** @type {!Array<TSource>} */
    AsyncObserver.prototype.values;
    /** @type {boolean} */
    AsyncObserver.prototype.hasError;
    /** @type {boolean} */
    AsyncObserver.prototype.hasCompleted;
    /** @type {?} */
    AsyncObserver.prototype.errorValue;
    /** @type {boolean} */
    AsyncObserver.prototype.closed;
}
/**
 * @template TSource, TResult
 */
class FromObservableAsyncIterable extends asynciterable_1.AsyncIterableX {
    /**
     * @param {!tsickle_forward_declare_6.Observable<TSource>} observable
     * @param {function(TSource, number): (TResult|!Promise<TResult>)} selector
     */
    constructor(observable, selector) {
        super();
        this._observable = observable;
        this._selector = selector;
    }
    /**
     * @return {!AsyncIterableIterator<TResult>}
     */
    async *[Symbol.asyncIterator]() {
        const /** @type {!AsyncObserver<TSource>} */ observer = new AsyncObserver();
        const /** @type {!Subscription} */ subscription = this._observable.subscribe(observer);
        let /** @type {number} */ i = 0;
        while (1) {
            if (observer.values.length > 0) {
                yield await this._selector(observer.values.shift(), i++);
            }
            else if (observer.closed) {
                subscription.unsubscribe();
                if (observer.hasError) {
                    throw observer.errorValue;
                }
                else {
                    break;
                }
            }
        }
    }
}
function FromObservableAsyncIterable_tsickle_Closure_declarations() {
    /** @type {!tsickle_forward_declare_6.Observable<TSource>} */
    FromObservableAsyncIterable.prototype._observable;
    /** @type {function(TSource, number): (TResult|!Promise<TResult>)} */
    FromObservableAsyncIterable.prototype._selector;
}
/** @typedef {(!PromiseLike<TSource>|!Iterable<(TSource|!PromiseLike<TSource>)>|!AsyncIterable<TSource>|!ArrayLike<TSource>|!tsickle_forward_declare_6.Observable<TSource>)} */
exports.AsyncIterableInput;
/**
 * @param {?} x
 * @return {boolean}
 */
function isPromise(x) {
    return x != null && Object(x) === x && typeof x['then'] === 'function';
}
/**
 * @param {?} x
 * @return {boolean}
 */
function isObservable(x) {
    return x != null && Object(x) === x && typeof x['subscribe'] === 'function';
}
/**
 * @param {?} x
 * @return {boolean}
 */
function isArrayLike(x) {
    return x != null && Object(x) === x && typeof x['length'] === 'number';
}
/**
 * @template TSource, TResult
 * @param {(!PromiseLike<TSource>|!Iterable<(TSource|!PromiseLike<TSource>)>|!AsyncIterable<TSource>|!ArrayLike<TSource>|!tsickle_forward_declare_6.Observable<TSource>)} source
 * @param {function(TSource, number): (TResult|!Promise<TResult>)=} selector
 * @param {?=} thisArg
 * @return {!tsickle_forward_declare_1.AsyncIterableX<TResult>}
 */
function from(source, selector = identity_1.identityAsync, thisArg) {
    const /** @type {?} */ fn = bindcallback_1.bindCallback(selector, thisArg, 2);
    if (isiterable_1.isIterable(source) || isiterable_1.isAsyncIterable(source)) {
        return new FromAsyncIterable(source, fn);
    }
    if (isPromise(source)) {
        return new FromPromiseIterable(source, fn);
    }
    if (isObservable(source)) {
        return new FromObservableAsyncIterable(source, fn);
    }
    if (isArrayLike(source)) {
        return new FromArrayIterable(source, fn);
    }
    throw new TypeError('Input type not supported');
}
exports.from = from;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9hc3luY2l0ZXJhYmxlL2Zyb20udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztHQUdHOztBQUVILG9EQUx1QjtBQU12QixNQUFNLHlCQUF5QixHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsMkNBQTJDLENBQUMsQ0FOaEQ7QUFPbEQsMkRBTnFCO0FBT3JCLE1BQU0seUJBQXlCLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxtREFBbUQsQ0FBQyxDQVBsRDtBQVF4RCxtREFQc0I7QUFRdEIsTUFBTSx5QkFBeUIsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLCtDQUErQyxDQUFDLENBUmpEO0FBU3JELG1EQVJpQjtBQVNqQixNQUFNLHlCQUF5QixHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsK0NBQStDLENBQUMsQ0FUdEQ7QUFVaEQsdURBVG9DO0FBVXBDLE1BQU0seUJBQXlCLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxpREFBaUQsQ0FBQyxDQVZuQztBQVlyRSxNQUFNLHlCQUF5QixHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsc0NBQXNDLENBQUMsQ0FBQztBQUM5RixJQUFJLENBQUMsT0FBTyxDQUFDLHNDQUFzQyxDQUFDLENBQUMsQ0FBQyxzQ0FBc0M7QUFDNUY7O0dBRUc7QUFiSCx1QkFBbUQsU0FBUSw4QkFBd0I7SUFpQm5GOzs7T0FHRztJQWhCRCxZQWtCSSxNQWpCMEIsRUFrQjFCLFFBakJ1RTtRQWtCekUsS0FqQkssRUFBRSxDQUFDO1FBa0JSLElBakJJLENBQUMsT0FBTyxHQUFFLE1BQU8sQ0FBQztRQWtCdEIsSUFqQkksQ0FBQyxTQUFTLEdBQUUsUUFBUyxDQUFDO0lBa0I1QixDQUFDO0lBQ0g7O09BRUc7SUFsQkQsS0FBSyxFQUFFLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQztRQW9CM0IsSUFBSSxxQkFuQkQsQ0FBQSxDQUFFLEdBQUUsQ0FBRSxDQUFDO1FBb0JWLE1BQU0scUJBbkJELENBQUEsTUFB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TSxDQUFDLENBQUMsQ0FBQSxDQUFFO1FBa0h6QixNQWpITSxDQUFBLElBQUksMkJBQTRCLENBQW1CLE1BQU0sRUFBQyxFQUFHLENBQUMsQ0FBQztJQWtIdkUsQ0FqSEM7SUFrSEQsRUFBRSxDQUFDLENBakhDLFdBQVcsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFBLENBQUU7UUFrSHhCLE1BakhNLENBQUEsSUFBSSxpQkFBa0IsQ0FBbUIsTUFBTSxFQUFDLEVBQUcsQ0FBQyxDQUFDO0lBa0g3RCxDQWpIQztJQW1IRCxNQWpISyxJQUFJLFNBQVUsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0FBa0hsRCxDQWpIQztBQW5CRCxvQkFtQkMiLCJmaWxlIjoiZnJvbS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlb3ZlcnZpZXcgYWRkZWQgYnkgdHNpY2tsZVxuICogQHN1cHByZXNzIHtjaGVja1R5cGVzfSBjaGVja2VkIGJ5IHRzY1xuICovXG5cbmltcG9ydCB7IEFzeW5jSXRlcmFibGVYIH0gZnJvbSAnLi4vYXN5bmNpdGVyYWJsZSc7XG5jb25zdCB0c2lja2xlX2ZvcndhcmRfZGVjbGFyZV8xID0gZ29vZy5mb3J3YXJkRGVjbGFyZShcIl9Vc2Vycy5wdGF5bG9yLmRldi5peGpzLnNyYy5hc3luY2l0ZXJhYmxlXCIpO1xuaW1wb3J0IHsgYmluZENhbGxiYWNrIH0gZnJvbSAnLi4vaW50ZXJuYWwvYmluZGNhbGxiYWNrJztcbmNvbnN0IHRzaWNrbGVfZm9yd2FyZF9kZWNsYXJlXzIgPSBnb29nLmZvcndhcmREZWNsYXJlKFwiX1VzZXJzLnB0YXlsb3IuZGV2Lml4anMuc3JjLmludGVybmFsLmJpbmRjYWxsYmFja1wiKTtcbmltcG9ydCB7IGlkZW50aXR5QXN5bmMgfSBmcm9tICcuLi9pbnRlcm5hbC9pZGVudGl0eSc7XG5jb25zdCB0c2lja2xlX2ZvcndhcmRfZGVjbGFyZV8zID0gZ29vZy5mb3J3YXJkRGVjbGFyZShcIl9Vc2Vycy5wdGF5bG9yLmRldi5peGpzLnNyYy5pbnRlcm5hbC5pZGVudGl0eVwiKTtcbmltcG9ydCB7IHRvTGVuZ3RoIH0gZnJvbSAnLi4vaW50ZXJuYWwvdG9sZW5ndGgnO1xuY29uc3QgdHNpY2tsZV9mb3J3YXJkX2RlY2xhcmVfNCA9IGdvb2cuZm9yd2FyZERlY2xhcmUoXCJfVXNlcnMucHRheWxvci5kZXYuaXhqcy5zcmMuaW50ZXJuYWwudG9sZW5ndGhcIik7XG5pbXBvcnQgeyBpc0l0ZXJhYmxlLCBpc0FzeW5jSXRlcmFibGUgfSBmcm9tICcuLi9pbnRlcm5hbC9pc2l0ZXJhYmxlJztcbmNvbnN0IHRzaWNrbGVfZm9yd2FyZF9kZWNsYXJlXzUgPSBnb29nLmZvcndhcmREZWNsYXJlKFwiX1VzZXJzLnB0YXlsb3IuZGV2Lml4anMuc3JjLmludGVybmFsLmlzaXRlcmFibGVcIik7XG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAnLi4vb2JzZXJ2ZXInO1xuY29uc3QgdHNpY2tsZV9mb3J3YXJkX2RlY2xhcmVfNiA9IGdvb2cuZm9yd2FyZERlY2xhcmUoXCJfVXNlcnMucHRheWxvci5kZXYuaXhqcy5zcmMub2JzZXJ2ZXJcIik7XG5nb29nLnJlcXVpcmUoXCJfVXNlcnMucHRheWxvci5kZXYuaXhqcy5zcmMub2JzZXJ2ZXJcIik7IC8vIGZvcmNlIHR5cGUtb25seSBtb2R1bGUgdG8gYmUgbG9hZGVkXG4vKipcbiAqIEB0ZW1wbGF0ZSBUU291cmNlLCBUUmVzdWx0XG4gKi9cbmNsYXNzIEZyb21BcnJheUl0ZXJhYmxlPFRTb3VyY2UsIFRSZXN1bHQgPSBUU291cmNlPiBleHRlbmRzIEFzeW5jSXRlcmFibGVYPFRSZXN1bHQ+IHtcbnByaXZhdGUgX3NvdXJjZTogQXJyYXlMaWtlPFRTb3VyY2U+O1xucHJpdmF0ZSBfc2VsZWN0b3I6ICh2YWx1ZTogVFNvdXJjZSwgaW5kZXg6IG51bWJlcikgPT4gVFJlc3VsdCB8IFByb21pc2U8VFJlc3VsdD47XG4vKipcbiAqIEBwYXJhbSB7IUFycmF5TGlrZTxUU291cmNlPn0gc291cmNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKFRTb3VyY2UsIG51bWJlcik6IChUUmVzdWx0fCFQcm9taXNlPFRSZXN1bHQ+KX0gc2VsZWN0b3JcbiAqL1xuY29uc3RydWN0b3IoXG4gICAgICBzb3VyY2U6IEFycmF5TGlrZTxUU291cmNlPixcbiAgICAgIHNlbGVjdG9yOiAodmFsdWU6IFRTb3VyY2UsIGluZGV4OiBudW1iZXIpID0+IFRSZXN1bHQgfCBQcm9taXNlPFRSZXN1bHQ+KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9zb3VyY2UgPSBzb3VyY2U7XG4gICAgdGhpcy5fc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgfVxuLyoqXG4gKiBAcmV0dXJuIHshQXN5bmNJdGVyYWJsZUl0ZXJhdG9yPFRSZXN1bHQ+fVxuICovXG5hc3luYyAqW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpIHtcbiAgICBsZXQgLyoqIEB0eXBlIHtudW1iZXJ9ICovIGkgPSAwO1xuICAgIGNvbnN0IC8qKiBAdHlwZSB7bnVtYmVyfSAqLyBsZW5ndGggPSB0b0xlbmd0aCgoIC8qKiBAdHlwZSB7IUFycmF5TGlrZTxUU291cmNlPn0gKi8oKDxBcnJheUxpa2U8VFNvdXJjZT4+dGhpcy5fc291cmNlKSkpLmxlbmd0aCk7XG4gICAgd2hpbGUgKGkgPCBsZW5ndGgpIHtcbiAgICAgIHlpZWxkIGF3YWl0IHRoaXMuX3NlbGVjdG9yKHRoaXMuX3NvdXJjZVtpXSwgaSsrKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gRnJvbUFycmF5SXRlcmFibGVfdHNpY2tsZV9DbG9zdXJlX2RlY2xhcmF0aW9ucygpIHtcbi8qKiBAdHlwZSB7IUFycmF5TGlrZTxUU291cmNlPn0gKi9cbkZyb21BcnJheUl0ZXJhYmxlLnByb3RvdHlwZS5fc291cmNlO1xuLyoqIEB0eXBlIHtmdW5jdGlvbihUU291cmNlLCBudW1iZXIpOiAoVFJlc3VsdHwhUHJvbWlzZTxUUmVzdWx0Pil9ICovXG5Gcm9tQXJyYXlJdGVyYWJsZS5wcm90b3R5cGUuX3NlbGVjdG9yO1xufVxuXG4vKipcbiAqIEB0ZW1wbGF0ZSBUU291cmNlLCBUUmVzdWx0XG4gKi9cbmNsYXNzIEZyb21Bc3luY0l0ZXJhYmxlPFRTb3VyY2UsIFRSZXN1bHQgPSBUU291cmNlPiBleHRlbmRzIEFzeW5jSXRlcmFibGVYPFRSZXN1bHQ+IHtcbnByaXZhdGUgX3NvdXJjZTogSXRlcmFibGU8VFNvdXJjZSB8IFByb21pc2VMaWtlPFRTb3VyY2U+PiB8IEFzeW5jSXRlcmFibGU8VFNvdXJjZT47XG5wcml2YXRlIF9zZWxlY3RvcjogKHZhbHVlOiBUU291cmNlLCBpbmRleDogbnVtYmVyKSA9PiBUUmVzdWx0IHwgUHJvbWlzZTxUUmVzdWx0Pjtcbi8qKlxuICogQHBhcmFtIHsoIUl0ZXJhYmxlPChUU291cmNlfCFQcm9taXNlTGlrZTxUU291cmNlPik+fCFBc3luY0l0ZXJhYmxlPFRTb3VyY2U+KX0gc291cmNlXG4gKiBAcGFyYW0ge2Z1bmN0aW9uKFRTb3VyY2UsIG51bWJlcik6IChUUmVzdWx0fCFQcm9taXNlPFRSZXN1bHQ+KX0gc2VsZWN0b3JcbiAqL1xuY29uc3RydWN0b3IoXG4gICAgICBzb3VyY2U6IEl0ZXJhYmxlPFRTb3VyY2UgfCBQcm9taXNlTGlrZTxUU291cmNlPj4gfCBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+LFxuICAgICAgc2VsZWN0b3I6ICh2YWx1ZTogVFNvdXJjZSwgaW5kZXg6IG51bWJlcikgPT4gVFJlc3VsdCB8IFByb21pc2U8VFJlc3VsdD4pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX3NvdXJjZSA9IHNvdXJjZTtcbiAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xuICB9XG4vKipcbiAqIEByZXR1cm4geyFBc3luY0l0ZXJhYmxlSXRlcmF0b3I8VFJlc3VsdD59XG4gKi9cbmFzeW5jICpbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkge1xuICAgIGxldCAvKiogQHR5cGUge251bWJlcn0gKi8gaSA9IDA7XG4gICAgZm9yIGF3YWl0IChsZXQgLyoqIEB0eXBlIHtUU291cmNlfSAqLyBpdGVtIG9mIC8qKiBAdHlwZSB7IUFzeW5jSXRlcmFibGU8VFNvdXJjZT59ICovKCggPEFzeW5jSXRlcmFibGU8VFNvdXJjZT4+dGhpcy5fc291cmNlKSkpIHtcbiAgICAgIHlpZWxkIGF3YWl0IHRoaXMuX3NlbGVjdG9yKGl0ZW0sIGkrKyk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIEZyb21Bc3luY0l0ZXJhYmxlX3RzaWNrbGVfQ2xvc3VyZV9kZWNsYXJhdGlvbnMoKSB7XG4vKiogQHR5cGUgeyghSXRlcmFibGU8KFRTb3VyY2V8IVByb21pc2VMaWtlPFRTb3VyY2U+KT58IUFzeW5jSXRlcmFibGU8VFNvdXJjZT4pfSAqL1xuRnJvbUFzeW5jSXRlcmFibGUucHJvdG90eXBlLl9zb3VyY2U7XG4vKiogQHR5cGUge2Z1bmN0aW9uKFRTb3VyY2UsIG51bWJlcik6IChUUmVzdWx0fCFQcm9taXNlPFRSZXN1bHQ+KX0gKi9cbkZyb21Bc3luY0l0ZXJhYmxlLnByb3RvdHlwZS5fc2VsZWN0b3I7XG59XG5cbi8qKlxuICogQHRlbXBsYXRlIFRTb3VyY2UsIFRSZXN1bHRcbiAqL1xuY2xhc3MgRnJvbVByb21pc2VJdGVyYWJsZTxUU291cmNlLCBUUmVzdWx0ID0gVFNvdXJjZT4gZXh0ZW5kcyBBc3luY0l0ZXJhYmxlWDxUUmVzdWx0PiB7XG5wcml2YXRlIF9zb3VyY2U6IFByb21pc2VMaWtlPFRTb3VyY2U+O1xucHJpdmF0ZSBfc2VsZWN0b3I6ICh2YWx1ZTogVFNvdXJjZSwgaW5kZXg6IG51bWJlcikgPT4gVFJlc3VsdCB8IFByb21pc2U8VFJlc3VsdD47XG4vKipcbiAqIEBwYXJhbSB7IVByb21pc2VMaWtlPFRTb3VyY2U+fSBzb3VyY2VcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oVFNvdXJjZSwgbnVtYmVyKTogKFRSZXN1bHR8IVByb21pc2U8VFJlc3VsdD4pfSBzZWxlY3RvclxuICovXG5jb25zdHJ1Y3RvcihcbiAgICAgIHNvdXJjZTogUHJvbWlzZUxpa2U8VFNvdXJjZT4sXG4gICAgICBzZWxlY3RvcjogKHZhbHVlOiBUU291cmNlLCBpbmRleDogbnVtYmVyKSA9PiBUUmVzdWx0IHwgUHJvbWlzZTxUUmVzdWx0Pikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fc291cmNlID0gc291cmNlO1xuICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3I7XG4gIH1cbi8qKlxuICogQHJldHVybiB7IUFzeW5jSXRlcmFibGVJdGVyYXRvcjxUUmVzdWx0Pn1cbiAqL1xuYXN5bmMgKltTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKSB7XG4gICAgY29uc3QgLyoqIEB0eXBlIHtUU291cmNlfSAqLyBpdGVtID0gYXdhaXQgdGhpcy5fc291cmNlO1xuICAgIHlpZWxkIGF3YWl0IHRoaXMuX3NlbGVjdG9yKGl0ZW0sIDApO1xuICB9XG59XG5cbmZ1bmN0aW9uIEZyb21Qcm9taXNlSXRlcmFibGVfdHNpY2tsZV9DbG9zdXJlX2RlY2xhcmF0aW9ucygpIHtcbi8qKiBAdHlwZSB7IVByb21pc2VMaWtlPFRTb3VyY2U+fSAqL1xuRnJvbVByb21pc2VJdGVyYWJsZS5wcm90b3R5cGUuX3NvdXJjZTtcbi8qKiBAdHlwZSB7ZnVuY3Rpb24oVFNvdXJjZSwgbnVtYmVyKTogKFRSZXN1bHR8IVByb21pc2U8VFJlc3VsdD4pfSAqL1xuRnJvbVByb21pc2VJdGVyYWJsZS5wcm90b3R5cGUuX3NlbGVjdG9yO1xufVxuXG4vKipcbiAqIEB0ZW1wbGF0ZSBUU291cmNlXG4gKi9cbmNsYXNzIEFzeW5jT2JzZXJ2ZXI8VFNvdXJjZT4ge1xucHVibGljIHZhbHVlczogVFNvdXJjZVtdO1xucHVibGljIGhhc0Vycm9yOiBib29sZWFuO1xucHVibGljIGhhc0NvbXBsZXRlZDogYm9vbGVhbjtcbnB1YmxpYyBlcnJvclZhbHVlOiBhbnk7XG5wdWJsaWMgY2xvc2VkOiBib29sZWFuO1xuY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy52YWx1ZXMgPSBbXTtcbiAgICB0aGlzLmhhc0NvbXBsZXRlZCA9IGZhbHNlO1xuICAgIHRoaXMuaGFzRXJyb3IgPSBmYWxzZTtcbiAgICB0aGlzLmVycm9yVmFsdWUgPSBudWxsO1xuICAgIHRoaXMuY2xvc2VkID0gZmFsc2U7XG4gIH1cbi8qKlxuICogQHBhcmFtIHtUU291cmNlfSB2YWx1ZVxuICogQHJldHVybiB7dm9pZH1cbiAqL1xubmV4dCh2YWx1ZTogVFNvdXJjZSkge1xuICAgIGlmICghdGhpcy5jbG9zZWQpIHtcbiAgICAgIHRoaXMudmFsdWVzLnB1c2godmFsdWUpO1xuICAgIH1cbiAgfVxuLyoqXG4gKiBAcGFyYW0gez99IGVyclxuICogQHJldHVybiB7dm9pZH1cbiAqL1xuZXJyb3IoZXJyOiBhbnkpIHtcbiAgICBpZiAoIXRoaXMuY2xvc2VkKSB7XG4gICAgICB0aGlzLmNsb3NlZCA9IHRydWU7XG4gICAgICB0aGlzLmhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgIHRoaXMuZXJyb3JWYWx1ZSA9IGVycjtcbiAgICB9XG4gIH1cbi8qKlxuICogQHJldHVybiB7dm9pZH1cbiAqL1xuY29tcGxldGUoKSB7XG4gICAgaWYgKCF0aGlzLmNsb3NlZCkge1xuICAgICAgdGhpcy5jbG9zZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBBc3luY09ic2VydmVyX3RzaWNrbGVfQ2xvc3VyZV9kZWNsYXJhdGlvbnMoKSB7XG4vKiogQHR5cGUgeyFBcnJheTxUU291cmNlPn0gKi9cbkFzeW5jT2JzZXJ2ZXIucHJvdG90eXBlLnZhbHVlcztcbi8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cbkFzeW5jT2JzZXJ2ZXIucHJvdG90eXBlLmhhc0Vycm9yO1xuLyoqIEB0eXBlIHtib29sZWFufSAqL1xuQXN5bmNPYnNlcnZlci5wcm90b3R5cGUuaGFzQ29tcGxldGVkO1xuLyoqIEB0eXBlIHs/fSAqL1xuQXN5bmNPYnNlcnZlci5wcm90b3R5cGUuZXJyb3JWYWx1ZTtcbi8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cbkFzeW5jT2JzZXJ2ZXIucHJvdG90eXBlLmNsb3NlZDtcbn1cblxuLyoqXG4gKiBAdGVtcGxhdGUgVFNvdXJjZSwgVFJlc3VsdFxuICovXG5jbGFzcyBGcm9tT2JzZXJ2YWJsZUFzeW5jSXRlcmFibGU8VFNvdXJjZSwgVFJlc3VsdCA9IFRTb3VyY2U+IGV4dGVuZHMgQXN5bmNJdGVyYWJsZVg8VFJlc3VsdD4ge1xucHJpdmF0ZSBfb2JzZXJ2YWJsZTogT2JzZXJ2YWJsZTxUU291cmNlPjtcbnByaXZhdGUgX3NlbGVjdG9yOiAodmFsdWU6IFRTb3VyY2UsIGluZGV4OiBudW1iZXIpID0+IFRSZXN1bHQgfCBQcm9taXNlPFRSZXN1bHQ+O1xuLyoqXG4gKiBAcGFyYW0geyF0c2lja2xlX2ZvcndhcmRfZGVjbGFyZV82Lk9ic2VydmFibGU8VFNvdXJjZT59IG9ic2VydmFibGVcbiAqIEBwYXJhbSB7ZnVuY3Rpb24oVFNvdXJjZSwgbnVtYmVyKTogKFRSZXN1bHR8IVByb21pc2U8VFJlc3VsdD4pfSBzZWxlY3RvclxuICovXG5jb25zdHJ1Y3RvcihcbiAgICAgIG9ic2VydmFibGU6IE9ic2VydmFibGU8VFNvdXJjZT4sXG4gICAgICBzZWxlY3RvcjogKHZhbHVlOiBUU291cmNlLCBpbmRleDogbnVtYmVyKSA9PiBUUmVzdWx0IHwgUHJvbWlzZTxUUmVzdWx0Pikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fb2JzZXJ2YWJsZSA9IG9ic2VydmFibGU7XG4gICAgdGhpcy5fc2VsZWN0b3IgPSBzZWxlY3RvcjtcbiAgfVxuLyoqXG4gKiBAcmV0dXJuIHshQXN5bmNJdGVyYWJsZUl0ZXJhdG9yPFRSZXN1bHQ+fVxuICovXG5hc3luYyAqW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSgpIHtcbiAgICBjb25zdCAvKiogQHR5cGUgeyFBc3luY09ic2VydmVyPFRTb3VyY2U+fSAqLyBvYnNlcnZlciA9IG5ldyBBc3luY09ic2VydmVyPFRTb3VyY2U+KCk7XG4gICAgY29uc3QgLyoqIEB0eXBlIHshU3Vic2NyaXB0aW9ufSAqLyBzdWJzY3JpcHRpb24gPSB0aGlzLl9vYnNlcnZhYmxlLnN1YnNjcmliZShvYnNlcnZlcik7XG5cbiAgICBsZXQgLyoqIEB0eXBlIHtudW1iZXJ9ICovIGkgPSAwO1xuICAgIHdoaWxlICgxKSB7XG4gICAgICBpZiAob2JzZXJ2ZXIudmFsdWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgeWllbGQgYXdhaXQgdGhpcy5fc2VsZWN0b3Iob2JzZXJ2ZXIudmFsdWVzLnNoaWZ0KCksIGkrKyk7XG4gICAgICB9IGVsc2UgaWYgKG9ic2VydmVyLmNsb3NlZCkge1xuICAgICAgICBzdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgaWYgKG9ic2VydmVyLmhhc0Vycm9yKSB7XG4gICAgICAgICAgdGhyb3cgb2JzZXJ2ZXIuZXJyb3JWYWx1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBGcm9tT2JzZXJ2YWJsZUFzeW5jSXRlcmFibGVfdHNpY2tsZV9DbG9zdXJlX2RlY2xhcmF0aW9ucygpIHtcbi8qKiBAdHlwZSB7IXRzaWNrbGVfZm9yd2FyZF9kZWNsYXJlXzYuT2JzZXJ2YWJsZTxUU291cmNlPn0gKi9cbkZyb21PYnNlcnZhYmxlQXN5bmNJdGVyYWJsZS5wcm90b3R5cGUuX29ic2VydmFibGU7XG4vKiogQHR5cGUge2Z1bmN0aW9uKFRTb3VyY2UsIG51bWJlcik6IChUUmVzdWx0fCFQcm9taXNlPFRSZXN1bHQ+KX0gKi9cbkZyb21PYnNlcnZhYmxlQXN5bmNJdGVyYWJsZS5wcm90b3R5cGUuX3NlbGVjdG9yO1xufVxuXG5cbmV4cG9ydCB0eXBlIEFzeW5jSXRlcmFibGVJbnB1dDxUU291cmNlPiA9XG4gIEl0ZXJhYmxlPFRTb3VyY2UgfCBQcm9taXNlTGlrZTxUU291cmNlPj4gfFxuICBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+IHxcbiAgQXJyYXlMaWtlPFRTb3VyY2U+IHxcbiAgUHJvbWlzZUxpa2U8VFNvdXJjZT4gfFxuICBPYnNlcnZhYmxlPFRTb3VyY2U+O1xuLyoqIEB0eXBlZGVmIHsoIVByb21pc2VMaWtlPFRTb3VyY2U+fCFJdGVyYWJsZTwoVFNvdXJjZXwhUHJvbWlzZUxpa2U8VFNvdXJjZT4pPnwhQXN5bmNJdGVyYWJsZTxUU291cmNlPnwhQXJyYXlMaWtlPFRTb3VyY2U+fCF0c2lja2xlX2ZvcndhcmRfZGVjbGFyZV82Lk9ic2VydmFibGU8VFNvdXJjZT4pfSAqL1xuZXhwb3J0cy5Bc3luY0l0ZXJhYmxlSW5wdXQ7XG5cbi8qKlxuICogQHBhcmFtIHs/fSB4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc1Byb21pc2UoeDogYW55KTogeCBpcyBQcm9taXNlTGlrZTxhbnk+IHtcbiAgcmV0dXJuIHggIT0gbnVsbCAmJiBPYmplY3QoeCkgPT09IHggJiYgdHlwZW9mIHhbJ3RoZW4nXSA9PT0gJ2Z1bmN0aW9uJztcbn1cbi8qKlxuICogQHBhcmFtIHs/fSB4XG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc09ic2VydmFibGUoeDogYW55KTogeCBpcyBPYnNlcnZhYmxlPGFueT4ge1xuICByZXR1cm4geCAhPSBudWxsICYmIE9iamVjdCh4KSA9PT0geCAmJiB0eXBlb2YgeFsnc3Vic2NyaWJlJ10gPT09ICdmdW5jdGlvbic7XG59XG4vKipcbiAqIEBwYXJhbSB7P30geFxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gaXNBcnJheUxpa2UoeDogYW55KTogeCBpcyBBcnJheUxpa2U8YW55PiB7XG4gIHJldHVybiB4ICE9IG51bGwgJiYgT2JqZWN0KHgpID09PSB4ICYmIHR5cGVvZiB4WydsZW5ndGgnXSA9PT0gJ251bWJlcic7XG59XG4vKipcbiAqIEB0ZW1wbGF0ZSBUU291cmNlLCBUUmVzdWx0XG4gKiBAcGFyYW0geyghUHJvbWlzZUxpa2U8VFNvdXJjZT58IUl0ZXJhYmxlPChUU291cmNlfCFQcm9taXNlTGlrZTxUU291cmNlPik+fCFBc3luY0l0ZXJhYmxlPFRTb3VyY2U+fCFBcnJheUxpa2U8VFNvdXJjZT58IXRzaWNrbGVfZm9yd2FyZF9kZWNsYXJlXzYuT2JzZXJ2YWJsZTxUU291cmNlPil9IHNvdXJjZVxuICogQHBhcmFtIHtmdW5jdGlvbihUU291cmNlLCBudW1iZXIpOiAoVFJlc3VsdHwhUHJvbWlzZTxUUmVzdWx0Pik9fSBzZWxlY3RvclxuICogQHBhcmFtIHs/PX0gdGhpc0FyZ1xuICogQHJldHVybiB7IXRzaWNrbGVfZm9yd2FyZF9kZWNsYXJlXzEuQXN5bmNJdGVyYWJsZVg8VFJlc3VsdD59XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmcm9tPFRTb3VyY2UsIFRSZXN1bHQgPSBUU291cmNlPihcbiAgICBzb3VyY2U6IEFzeW5jSXRlcmFibGVJbnB1dDxUU291cmNlPixcbiAgICBzZWxlY3RvcjogKHZhbHVlOiBUU291cmNlLCBpbmRleDogbnVtYmVyKSA9PiBUUmVzdWx0IHwgUHJvbWlzZTxUUmVzdWx0PiA9IGlkZW50aXR5QXN5bmMsXG4gICAgdGhpc0FyZz86IGFueSk6IEFzeW5jSXRlcmFibGVYPFRSZXN1bHQ+IHtcbiAgY29uc3QgLyoqIEB0eXBlIHs/fSAqLyBmbiA9IGJpbmRDYWxsYmFjayhzZWxlY3RvciwgdGhpc0FyZywgMik7XG4gIGlmIChpc0l0ZXJhYmxlKHNvdXJjZSkgfHwgaXNBc3luY0l0ZXJhYmxlKHNvdXJjZSkpIHtcbiAgICByZXR1cm4gbmV3IEZyb21Bc3luY0l0ZXJhYmxlPFRTb3VyY2UsIFRSZXN1bHQ+KHNvdXJjZSwgZm4pO1xuICB9XG4gIGlmIChpc1Byb21pc2Uoc291cmNlKSkge1xuICAgIHJldHVybiBuZXcgRnJvbVByb21pc2VJdGVyYWJsZTxUU291cmNlLCBUUmVzdWx0Pihzb3VyY2UsIGZuKTtcbiAgfVxuICBpZiAoaXNPYnNlcnZhYmxlKHNvdXJjZSkpIHtcbiAgICByZXR1cm4gbmV3IEZyb21PYnNlcnZhYmxlQXN5bmNJdGVyYWJsZTxUU291cmNlLCBUUmVzdWx0Pihzb3VyY2UsIGZuKTtcbiAgfVxuICBpZiAoaXNBcnJheUxpa2Uoc291cmNlKSkge1xuICAgIHJldHVybiBuZXcgRnJvbUFycmF5SXRlcmFibGU8VFNvdXJjZSwgVFJlc3VsdD4oc291cmNlLCBmbik7XG4gIH1cblxuICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnB1dCB0eXBlIG5vdCBzdXBwb3J0ZWQnKTtcbn1cbiJdfQ==