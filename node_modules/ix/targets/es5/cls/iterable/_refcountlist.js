goog.module('targets.es5.cls.iterable._refcountlist'); exports = {}; var module = {id: 'targets/es5/cls/iterable/_refcountlist.js'};/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes} checked by tsc
 */

/**
 * @ignore
 * @record
 * @template T
 */
function RefCount() { }
exports.RefCount = RefCount;
function RefCount_tsickle_Closure_declarations() {
    /** @type {T} */
    RefCount.prototype.value;
    /** @type {number} */
    RefCount.prototype.count;
}
/**
 * @ignore
 * @record
 * @template T
 */
function IRefCountList() { }
exports.IRefCountList = IRefCountList;
function IRefCountList_tsickle_Closure_declarations() {
    /** @type {function(): void} */
    IRefCountList.prototype.clear;
    /** @type {number} */
    IRefCountList.prototype.count;
    /** @type {function(number): T} */
    IRefCountList.prototype.get;
    /** @type {function(T): void} */
    IRefCountList.prototype.push;
    /** @type {function(): void} */
    IRefCountList.prototype.done;
}
/**
 * @ignore
 * @template T
 * @implements {IRefCountList}
 */
var MaxRefCountList = (function () {
    function MaxRefCountList() {
        this._list = [];
    }
    /**
     * @return {void}
     */
    MaxRefCountList.prototype.clear = function () { this._list = []; };
    Object.defineProperty(MaxRefCountList.prototype, "count", {
        /**
         * @return {number}
         */
        get: function () { return this._list.length; },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {number} index
     * @return {T}
     */
    MaxRefCountList.prototype.get = function (index) { return this._list[index]; };
    /**
     * @param {T} value
     * @return {void}
     */
    MaxRefCountList.prototype.push = function (value) { this._list.push(value); };
    /**
     * @return {void}
     */
    MaxRefCountList.prototype.done = function () { };
    return MaxRefCountList;
}());
exports.MaxRefCountList = MaxRefCountList;
function MaxRefCountList_tsickle_Closure_declarations() {
    /** @type {!Array<T>} */
    MaxRefCountList.prototype._list;
}
/**
 * @ignore
 * @template T
 * @implements {IRefCountList}
 */
var RefCountList = (function () {
    /**
     * @param {number} readerCount
     */
    function RefCountList(readerCount) {
        this._count = 0;
        this._readerCount = readerCount;
        this._list = new Map();
    }
    /**
     * @return {void}
     */
    RefCountList.prototype.clear = function () { this._list.clear(); };
    Object.defineProperty(RefCountList.prototype, "count", {
        /**
         * @return {number}
         */
        get: function () { return this._count; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RefCountList.prototype, "readerCount", {
        /**
         * @return {number}
         */
        get: function () { return this._readerCount; },
        /**
         * @param {number} value
         * @return {void}
         */
        set: function (value) { this._readerCount = value; },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {void}
     */
    RefCountList.prototype.done = function () { this._readerCount--; };
    /**
     * @param {number} index
     * @return {T}
     */
    RefCountList.prototype.get = function (index) {
        if (!this._list.has(index)) {
            throw new Error('Element no longer available in the buffer.');
        }
        var /** @type {!RefCount<T>} */ res = ((this._list.get(index)));
        var /** @type {T} */ val = res.value;
        if (--res.count === 0) {
            this._list.delete(index);
        }
        return val;
    };
    /**
     * @param {T} value
     * @return {void}
     */
    RefCountList.prototype.push = function (value) {
        this._list.set(this._count++, { value: value, count: this._readerCount });
    };
    return RefCountList;
}());
exports.RefCountList = RefCountList;
function RefCountList_tsickle_Closure_declarations() {
    /** @type {number} */
    RefCountList.prototype._readerCount;
    /** @type {!Map<number, !RefCount<T>>} */
    RefCountList.prototype._list;
    /** @type {number} */
    RefCountList.prototype._count;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9pdGVyYWJsZS9fcmVmY291bnRsaXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7R0FHRzs7QUFHSDs7OztHQUlHO0FBQ0gsc0JBQTRCLENBQUM7QUFBN0IsNEJBQTZCO0FBRzdCO0lBQ0EsZ0JBQWdCO0lBQ2hCLFFBQVEsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDO0lBQ3pCLHFCQUFxQjtJQUNyQixRQUFRLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQztBQUN6QixDQUFDO0FBUUQ7Ozs7R0FJRztBQUNILDJCQUFpQyxDQUFDO0FBQWxDLHNDQUFrQztBQUdsQztJQUNBLCtCQUErQjtJQUMvQixhQUFhLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQztJQUM5QixxQkFBcUI7SUFDckIsYUFBYSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUM7SUFDOUIsa0NBQWtDO0lBQ2xDLGFBQWEsQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDO0lBQzVCLGdDQUFnQztJQUNoQyxhQUFhLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQztJQUM3QiwrQkFBK0I7SUFDL0IsYUFBYSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUM7QUFDN0IsQ0FBQztBQWFEOzs7O0dBSUc7QUF6Q0g7SUFBQTtRQUNTLFVBQU0sR0FBTyxFQUFHLENBQUE7SUFTekIsQ0FBQTtJQWtDQTs7T0FFRztJQTNDRCwrQkFBSyxHQUFMLGNBQVMsSUFBSyxDQUFDLEtBQUssR0FBRSxFQUFHLENBQUMsQ0FBQSxDQUFBO0lBQzFCLHNCQUFHLGtDQUFNO1FBNENYOztXQUVHO2FBOUNELGNBQWEsTUFBTyxDQUFBLElBQUssQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUEsQ0FBQTs7O09BQUE7SUFnRHpDOzs7T0FHRztJQWxERCw2QkFBRyxHQUFILFVBQUksS0FBYSxJQUFNLE1BQU8sQ0FBQSxJQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUEsQ0FBQTtJQW9EbkQ7OztPQUdHO0lBdERELDhCQUFJLEdBQUosVUFBSyxLQUFRLElBQUcsSUFBSyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQSxDQUFBO0lBd0QxQzs7T0FFRztJQXZERCw4QkFBSSxHQUFKLGNBQU0sQ0FBSTtJQUNaLHNCQUFBO0FBQUEsQ0FWQSxBQVVBLElBQUE7QUFWWSwwQ0FBZ0I7QUFvRTVCO0lBQ0Esd0JBQXdCO0lBQ3hCLGVBQWUsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDO0FBQ2hDLENBQUM7QUFFRDs7OztHQUlHO0FBOURIO0lBbUVBOztPQUVHO0lBaEVELHNCQUFZLFdBQW1CO1FBRnhCLFdBQU8sR0FBVSxDQUFFLENBQUE7UUFvRXhCLElBakVJLENBQUMsWUFBWSxHQUFFLFdBQVksQ0FBQztRQWtFaEMsSUFqRUksQ0FBQyxLQUFLLEdBQUUsSUFBSSxHQUFJLEVBQXVCLENBQUM7SUFrRTlDLENBQUM7SUFDSDs7T0FFRztJQWxFRCw0QkFBSyxHQUFMLGNBQVMsSUFBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFBLENBQUE7SUFDN0Isc0JBQUcsK0JBQU07UUFtRVg7O1dBRUc7YUFyRUQsY0FBYSxNQUFPLENBQUEsSUFBSyxDQUFDLE1BQU0sQ0FBQyxDQUFBLENBQUE7OztPQUFBO0lBQ2pDLHNCQUFHLHFDQUFZO1FBc0VqQjs7V0FFRzthQXhFRCxjQUFtQixNQUFPLENBQUEsSUFBSyxDQUFDLFlBQVksQ0FBQyxDQUFBLENBQUE7UUEwRS9DOzs7V0FHRzthQTVFRCxVQUFnQixLQUFhLElBQUcsSUFBSyxDQUFDLFlBQVksR0FBRSxLQUFNLENBQUMsQ0FBQSxDQUFBOzs7T0FEZDtJQStFL0M7O09BRUc7SUEvRUQsMkJBQUksR0FBSixjQUFRLElBQUssQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFBLENBQUE7SUFpRi9COzs7T0FHRztJQWxGRCwwQkFBRyxHQUFILFVBQUksS0FBYTtRQW9GZixFQUFFLENBQUMsQ0FuRkMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFBLENBQUU7WUFvRjNCLE1BbkZLLElBQUksS0FBTSxDQUFDLDRDQUE0QyxDQUFDLENBQUM7UUFvRmhFLENBbkZDO1FBb0ZELElBQU0sMkJBbkZELENBQUEsR0FBSSxHQUFBLENBQUEsQ0FBRSxJQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUEsQ0FBQSxDQUFFLENBQUM7UUFvRm5DLElBQU0sZ0JBbkZELENBQUEsR0FBSSxHQUFFLEdBQUksQ0FBQyxLQUFLLENBQUM7UUFvRnRCLEVBQUUsQ0FBQyxDQW5GQyxFQUFFLEdBQUcsQ0FBQyxLQUFLLEtBQUksQ0FBRSxDQUFDLENBQUEsQ0FBRTtZQW9GdEIsSUFuRkksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBb0YzQixDQW5GQztRQW9GRCxNQW5GTSxDQUFBLEdBQUksQ0FBQztJQW9GYixDQUFDO0lBQ0g7OztPQUdHO0lBckZELDJCQUFJLEdBQUosVUFBSyxLQUFRO1FBdUZYLElBdEZJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEVBQUMsRUFBRSxLQUFNLEVBQUMsS0FBTSxFQUFDLEtBQU0sRUFBQyxJQUFLLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQztJQXVGNUUsQ0F0RkM7SUFDSCxtQkFBQTtBQUFBLENBL0JBLEFBK0JBLElBQUE7QUEvQlksb0NBQWE7QUF1SHpCO0lBQ0EscUJBQXFCO0lBQ3JCLFlBQVksQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDO0lBQ3BDLHlDQUF5QztJQUN6QyxZQUFZLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQztJQUM3QixxQkFBcUI7SUFDckIsWUFBWSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUM7QUFDOUIsQ0FBQyIsImZpbGUiOiJfcmVmY291bnRsaXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGZpbGVvdmVydmlldyBhZGRlZCBieSB0c2lja2xlXG4gKiBAc3VwcHJlc3Mge2NoZWNrVHlwZXN9IGNoZWNrZWQgYnkgdHNjXG4gKi9cblxuXG4vKipcbiAqIEBpZ25vcmVcbiAqIEByZWNvcmRcbiAqIEB0ZW1wbGF0ZSBUXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBSZWZDb3VudCgpIHt9XG5cblxuZnVuY3Rpb24gUmVmQ291bnRfdHNpY2tsZV9DbG9zdXJlX2RlY2xhcmF0aW9ucygpIHtcbi8qKiBAdHlwZSB7VH0gKi9cblJlZkNvdW50LnByb3RvdHlwZS52YWx1ZTtcbi8qKiBAdHlwZSB7bnVtYmVyfSAqL1xuUmVmQ291bnQucHJvdG90eXBlLmNvdW50O1xufVxuLyoqXG4gKiBAaWdub3JlXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgUmVmQ291bnQ8VD4ge1xuICB2YWx1ZTogVDtcbiAgY291bnQ6IG51bWJlcjtcbn1cbi8qKlxuICogQGlnbm9yZVxuICogQHJlY29yZFxuICogQHRlbXBsYXRlIFRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIElSZWZDb3VudExpc3QoKSB7fVxuXG5cbmZ1bmN0aW9uIElSZWZDb3VudExpc3RfdHNpY2tsZV9DbG9zdXJlX2RlY2xhcmF0aW9ucygpIHtcbi8qKiBAdHlwZSB7ZnVuY3Rpb24oKTogdm9pZH0gKi9cbklSZWZDb3VudExpc3QucHJvdG90eXBlLmNsZWFyO1xuLyoqIEB0eXBlIHtudW1iZXJ9ICovXG5JUmVmQ291bnRMaXN0LnByb3RvdHlwZS5jb3VudDtcbi8qKiBAdHlwZSB7ZnVuY3Rpb24obnVtYmVyKTogVH0gKi9cbklSZWZDb3VudExpc3QucHJvdG90eXBlLmdldDtcbi8qKiBAdHlwZSB7ZnVuY3Rpb24oVCk6IHZvaWR9ICovXG5JUmVmQ291bnRMaXN0LnByb3RvdHlwZS5wdXNoO1xuLyoqIEB0eXBlIHtmdW5jdGlvbigpOiB2b2lkfSAqL1xuSVJlZkNvdW50TGlzdC5wcm90b3R5cGUuZG9uZTtcbn1cblxuXG4vKipcbiAqIEBpZ25vcmVcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJUmVmQ291bnRMaXN0PFQ+IHtcbiAgY2xlYXIoKTogdm9pZDtcbiAgcmVhZG9ubHkgY291bnQ6IG51bWJlcjtcbiAgZ2V0KGluZGV4OiBudW1iZXIpOiBUO1xuICBwdXNoKHZhbHVlOiBUKTogdm9pZDtcbiAgZG9uZSgpOiB2b2lkO1xufVxuLyoqXG4gKiBAaWdub3JlXG4gKiBAdGVtcGxhdGUgVFxuICogQGltcGxlbWVudHMge0lSZWZDb3VudExpc3R9XG4gKi9cbmV4cG9ydCBjbGFzcyBNYXhSZWZDb3VudExpc3Q8VD4gaW1wbGVtZW50cyBJUmVmQ291bnRMaXN0PFQ+IHtcbnByaXZhdGUgX2xpc3Q6IFRbXSA9IFtdO1xuLyoqXG4gKiBAcmV0dXJuIHt2b2lkfVxuICovXG5jbGVhcigpIHsgdGhpcy5fbGlzdCA9IFtdOyB9XG4vKipcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xuZ2V0IGNvdW50KCkgeyByZXR1cm4gdGhpcy5fbGlzdC5sZW5ndGg7IH1cbi8qKlxuICogQHBhcmFtIHtudW1iZXJ9IGluZGV4XG4gKiBAcmV0dXJuIHtUfVxuICovXG5nZXQoaW5kZXg6IG51bWJlcik6IFQgeyByZXR1cm4gdGhpcy5fbGlzdFtpbmRleF07IH1cbi8qKlxuICogQHBhcmFtIHtUfSB2YWx1ZVxuICogQHJldHVybiB7dm9pZH1cbiAqL1xucHVzaCh2YWx1ZTogVCkgeyB0aGlzLl9saXN0LnB1c2godmFsdWUpOyB9XG4vKipcbiAqIEByZXR1cm4ge3ZvaWR9XG4gKi9cbmRvbmUoKSB7IH1cbn1cblxuZnVuY3Rpb24gTWF4UmVmQ291bnRMaXN0X3RzaWNrbGVfQ2xvc3VyZV9kZWNsYXJhdGlvbnMoKSB7XG4vKiogQHR5cGUgeyFBcnJheTxUPn0gKi9cbk1heFJlZkNvdW50TGlzdC5wcm90b3R5cGUuX2xpc3Q7XG59XG5cbi8qKlxuICogQGlnbm9yZVxuICogQHRlbXBsYXRlIFRcbiAqIEBpbXBsZW1lbnRzIHtJUmVmQ291bnRMaXN0fVxuICovXG5leHBvcnQgY2xhc3MgUmVmQ291bnRMaXN0PFQ+IGltcGxlbWVudHMgSVJlZkNvdW50TGlzdDxUPiB7XG5wcml2YXRlIF9yZWFkZXJDb3VudDogbnVtYmVyO1xucHJpdmF0ZSBfbGlzdDogTWFwPG51bWJlciwgUmVmQ291bnQ8VD4+O1xucHJpdmF0ZSBfY291bnQ6IG51bWJlciA9IDA7XG4vKipcbiAqIEBwYXJhbSB7bnVtYmVyfSByZWFkZXJDb3VudFxuICovXG5jb25zdHJ1Y3RvcihyZWFkZXJDb3VudDogbnVtYmVyKSB7XG4gICAgdGhpcy5fcmVhZGVyQ291bnQgPSByZWFkZXJDb3VudDtcbiAgICB0aGlzLl9saXN0ID0gbmV3IE1hcDxudW1iZXIsIFJlZkNvdW50PFQ+PigpO1xuICB9XG4vKipcbiAqIEByZXR1cm4ge3ZvaWR9XG4gKi9cbmNsZWFyKCkgeyB0aGlzLl9saXN0LmNsZWFyKCk7IH1cbi8qKlxuICogQHJldHVybiB7bnVtYmVyfVxuICovXG5nZXQgY291bnQoKSB7IHJldHVybiB0aGlzLl9jb3VudDsgfVxuLyoqXG4gKiBAcmV0dXJuIHtudW1iZXJ9XG4gKi9cbmdldCByZWFkZXJDb3VudCgpIHsgcmV0dXJuIHRoaXMuX3JlYWRlckNvdW50OyB9XG4vKipcbiAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICogQHJldHVybiB7dm9pZH1cbiAqL1xuc2V0IHJlYWRlckNvdW50KHZhbHVlOiBudW1iZXIpIHsgdGhpcy5fcmVhZGVyQ291bnQgPSB2YWx1ZTsgfVxuLyoqXG4gKiBAcmV0dXJuIHt2b2lkfVxuICovXG5kb25lKCkgeyB0aGlzLl9yZWFkZXJDb3VudC0tOyB9XG4vKipcbiAqIEBwYXJhbSB7bnVtYmVyfSBpbmRleFxuICogQHJldHVybiB7VH1cbiAqL1xuZ2V0KGluZGV4OiBudW1iZXIpOiBUIHtcbiAgICBpZiAoIXRoaXMuX2xpc3QuaGFzKGluZGV4KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdFbGVtZW50IG5vIGxvbmdlciBhdmFpbGFibGUgaW4gdGhlIGJ1ZmZlci4nKTtcbiAgICB9XG4gICAgY29uc3QgLyoqIEB0eXBlIHshUmVmQ291bnQ8VD59ICovIHJlcyA9IC8qKiBAdHlwZSB7IVJlZkNvdW50PFQ+fSAqLygoIHRoaXMuX2xpc3QuZ2V0KGluZGV4KSkpO1xuICAgIGNvbnN0IC8qKiBAdHlwZSB7VH0gKi8gdmFsID0gcmVzLnZhbHVlO1xuICAgIGlmICgtLXJlcy5jb3VudCA9PT0gMCkge1xuICAgICAgdGhpcy5fbGlzdC5kZWxldGUoaW5kZXgpO1xuICAgIH1cbiAgICByZXR1cm4gdmFsO1xuICB9XG4vKipcbiAqIEBwYXJhbSB7VH0gdmFsdWVcbiAqIEByZXR1cm4ge3ZvaWR9XG4gKi9cbnB1c2godmFsdWU6IFQpIHtcbiAgICB0aGlzLl9saXN0LnNldCh0aGlzLl9jb3VudCsrLCB7IHZhbHVlOiB2YWx1ZSwgY291bnQ6IHRoaXMuX3JlYWRlckNvdW50IH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIFJlZkNvdW50TGlzdF90c2lja2xlX0Nsb3N1cmVfZGVjbGFyYXRpb25zKCkge1xuLyoqIEB0eXBlIHtudW1iZXJ9ICovXG5SZWZDb3VudExpc3QucHJvdG90eXBlLl9yZWFkZXJDb3VudDtcbi8qKiBAdHlwZSB7IU1hcDxudW1iZXIsICFSZWZDb3VudDxUPj59ICovXG5SZWZDb3VudExpc3QucHJvdG90eXBlLl9saXN0O1xuLyoqIEB0eXBlIHtudW1iZXJ9ICovXG5SZWZDb3VudExpc3QucHJvdG90eXBlLl9jb3VudDtcbn1cblxuIl19