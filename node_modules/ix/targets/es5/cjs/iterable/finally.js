Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var iterable_1 = require("../iterable");
var FinalyIterable = (function (_super) {
    tslib_1.__extends(FinalyIterable, _super);
    function FinalyIterable(source, action) {
        var _this = _super.call(this) || this;
        _this._source = source;
        _this._action = action;
        return _this;
    }
    FinalyIterable.prototype[Symbol.iterator] = function () {
        return tslib_1.__generator(this, function (_a) {
            switch (_a.label) {
                case 0:
                    _a.trys.push([0, , 2, 3]);
                    return [5 /*yield**/, tslib_1.__values(this._source)];
                case 1:
                    _a.sent();
                    return [3 /*break*/, 3];
                case 2:
                    this._action();
                    return [7 /*endfinally*/];
                case 3: return [2 /*return*/];
            }
        });
    };
    return FinalyIterable;
}(iterable_1.IterableX));
/**
 * Creates a sequence whose termination or disposal of an iterator causes a finally action to be executed.
 * @param {Iterator<T>} source Source sequence
 * @param {function(): void)} action Action to run upon termination of the sequence, or when an iterator is disposed.
 * @return {Iterable<T>} Source sequence with guarantees on the invocation of the finally action.
 */
function _finally(source, action) {
    return new FinalyIterable(source, action);
}
exports._finally = _finally;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIml0ZXJhYmxlL2ZpbmFsbHkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSx3Q0FBd0M7QUFFeEM7SUFBc0MsMENBQWtCO0lBSXRELHdCQUFZLE1BQXlCLEVBQUUsTUFBa0I7UUFBekQsWUFDRSxpQkFBTyxTQUdSO1FBRkMsS0FBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7UUFDdEIsS0FBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7O0lBQ3hCLENBQUM7SUFFQSx5QkFBQyxNQUFNLENBQUMsUUFBUSxDQUFDLEdBQWxCOzs7OztvQkFFSSxzQkFBQSxpQkFBTyxJQUFJLENBQUMsT0FBTyxDQUFBLEVBQUE7O29CQUFuQixTQUFtQixDQUFDOzs7b0JBRXBCLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQzs7Ozs7S0FFbEI7SUFDSCxxQkFBQztBQUFELENBakJBLEFBaUJDLENBakJxQyxvQkFBUyxHQWlCOUM7QUFFRDs7Ozs7R0FLRztBQUNILGtCQUNJLE1BQXlCLEVBQ3pCLE1BQWtCO0lBQ3BCLE1BQU0sQ0FBQyxJQUFJLGNBQWMsQ0FBVSxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFDckQsQ0FBQztBQUpELDRCQUlDIiwiZmlsZSI6Iml0ZXJhYmxlL2ZpbmFsbHkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJdGVyYWJsZVggfSBmcm9tICcuLi9pdGVyYWJsZSc7XG5cbmNsYXNzIEZpbmFseUl0ZXJhYmxlPFRTb3VyY2U+IGV4dGVuZHMgSXRlcmFibGVYPFRTb3VyY2U+IHtcbiAgcHJpdmF0ZSBfc291cmNlOiBJdGVyYWJsZTxUU291cmNlPjtcbiAgcHJpdmF0ZSBfYWN0aW9uOiAoKSA9PiB2b2lkO1xuXG4gIGNvbnN0cnVjdG9yKHNvdXJjZTogSXRlcmFibGU8VFNvdXJjZT4sIGFjdGlvbjogKCkgPT4gdm9pZCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fc291cmNlID0gc291cmNlO1xuICAgIHRoaXMuX2FjdGlvbiA9IGFjdGlvbjtcbiAgfVxuXG4gICpbU3ltYm9sLml0ZXJhdG9yXSgpIHtcbiAgICB0cnkge1xuICAgICAgeWllbGQqIHRoaXMuX3NvdXJjZTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgdGhpcy5fYWN0aW9uKCk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHNlcXVlbmNlIHdob3NlIHRlcm1pbmF0aW9uIG9yIGRpc3Bvc2FsIG9mIGFuIGl0ZXJhdG9yIGNhdXNlcyBhIGZpbmFsbHkgYWN0aW9uIHRvIGJlIGV4ZWN1dGVkLlxuICogQHBhcmFtIHtJdGVyYXRvcjxUPn0gc291cmNlIFNvdXJjZSBzZXF1ZW5jZVxuICogQHBhcmFtIHtmdW5jdGlvbigpOiB2b2lkKX0gYWN0aW9uIEFjdGlvbiB0byBydW4gdXBvbiB0ZXJtaW5hdGlvbiBvZiB0aGUgc2VxdWVuY2UsIG9yIHdoZW4gYW4gaXRlcmF0b3IgaXMgZGlzcG9zZWQuXG4gKiBAcmV0dXJuIHtJdGVyYWJsZTxUPn0gU291cmNlIHNlcXVlbmNlIHdpdGggZ3VhcmFudGVlcyBvbiB0aGUgaW52b2NhdGlvbiBvZiB0aGUgZmluYWxseSBhY3Rpb24uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBfZmluYWxseTxUU291cmNlPihcbiAgICBzb3VyY2U6IEl0ZXJhYmxlPFRTb3VyY2U+LFxuICAgIGFjdGlvbjogKCkgPT4gdm9pZCk6IEl0ZXJhYmxlWDxUU291cmNlPiB7XG4gIHJldHVybiBuZXcgRmluYWx5SXRlcmFibGU8VFNvdXJjZT4oc291cmNlLCBhY3Rpb24pO1xufVxuIl19
