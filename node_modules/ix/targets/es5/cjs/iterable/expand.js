Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var iterable_1 = require("../iterable");
var ExpandIterable = (function (_super) {
    tslib_1.__extends(ExpandIterable, _super);
    function ExpandIterable(source, fn) {
        var _this = _super.call(this) || this;
        _this._source = source;
        _this._fn = fn;
        return _this;
    }
    ExpandIterable.prototype[Symbol.iterator] = function () {
        var q, src, _a, _b, item, e_1_1, e_1, _c;
        return tslib_1.__generator(this, function (_d) {
            switch (_d.label) {
                case 0:
                    q = [this._source];
                    _d.label = 1;
                case 1:
                    if (!(q.length > 0)) return [3 /*break*/, 10];
                    src = q.shift();
                    _d.label = 2;
                case 2:
                    _d.trys.push([2, 7, 8, 9]);
                    _a = tslib_1.__values(src), _b = _a.next();
                    _d.label = 3;
                case 3:
                    if (!!_b.done) return [3 /*break*/, 6];
                    item = _b.value;
                    q.push(this._fn(item));
                    return [4 /*yield*/, item];
                case 4:
                    _d.sent();
                    _d.label = 5;
                case 5:
                    _b = _a.next();
                    return [3 /*break*/, 3];
                case 6: return [3 /*break*/, 9];
                case 7:
                    e_1_1 = _d.sent();
                    e_1 = { error: e_1_1 };
                    return [3 /*break*/, 9];
                case 8:
                    try {
                        if (_b && !_b.done && (_c = _a.return)) _c.call(_a);
                    }
                    finally { if (e_1) throw e_1.error; }
                    return [7 /*endfinally*/];
                case 9: return [3 /*break*/, 1];
                case 10: return [2 /*return*/];
            }
        });
    };
    return ExpandIterable;
}(iterable_1.IterableX));
/**
 * Expands the sequence by recursively applying a selector function.
 * @param {Iterable<T>} source Source sequence.
 * @param {function(value: T): Iterable<T>} selector Selector function to retrieve the next sequence to expand
 * @return {Iterable<T>} Sequence with results from the recursive expansion of the source sequence.
 */
function expand(source, selector) {
    return new ExpandIterable(source, selector);
}
exports.expand = expand;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIml0ZXJhYmxlL2V4cGFuZC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHdDQUF3QztBQUV4QztJQUFzQywwQ0FBa0I7SUFJdEQsd0JBQVksTUFBeUIsRUFBRSxFQUF5QztRQUFoRixZQUNFLGlCQUFPLFNBR1I7UUFGQyxLQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztRQUN0QixLQUFJLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQzs7SUFDaEIsQ0FBQztJQUVBLHlCQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsR0FBbEI7Ozs7O29CQUNNLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQzs7O3lCQUNoQixDQUFBLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFBO29CQUNiLEdBQUcsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUM7Ozs7b0JBQ0gsS0FBQSxpQkFBQSxHQUFJLENBQUE7Ozs7b0JBQVosSUFBSTtvQkFDWCxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztvQkFDdkIscUJBQU0sSUFBSSxFQUFBOztvQkFBVixTQUFVLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0tBR2hCO0lBQ0gscUJBQUM7QUFBRCxDQXBCQSxBQW9CQyxDQXBCcUMsb0JBQVMsR0FvQjlDO0FBRUQ7Ozs7O0dBS0c7QUFDSCxnQkFDSSxNQUF5QixFQUN6QixRQUErQztJQUNqRCxNQUFNLENBQUMsSUFBSSxjQUFjLENBQVUsTUFBTSxFQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQ3RELENBQUM7QUFKRCx3QkFJQyIsImZpbGUiOiJpdGVyYWJsZS9leHBhbmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJdGVyYWJsZVggfSBmcm9tICcuLi9pdGVyYWJsZSc7XG5cbmNsYXNzIEV4cGFuZEl0ZXJhYmxlPFRTb3VyY2U+IGV4dGVuZHMgSXRlcmFibGVYPFRTb3VyY2U+IHtcbiAgcHJpdmF0ZSBfc291cmNlOiBJdGVyYWJsZTxUU291cmNlPjtcbiAgcHJpdmF0ZSBfZm46ICh2YWx1ZTogVFNvdXJjZSkgPT4gSXRlcmFibGU8VFNvdXJjZT47XG5cbiAgY29uc3RydWN0b3Ioc291cmNlOiBJdGVyYWJsZTxUU291cmNlPiwgZm46ICh2YWx1ZTogVFNvdXJjZSkgPT4gSXRlcmFibGU8VFNvdXJjZT4pIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX3NvdXJjZSA9IHNvdXJjZTtcbiAgICB0aGlzLl9mbiA9IGZuO1xuICB9XG5cbiAgKltTeW1ib2wuaXRlcmF0b3JdKCkge1xuICAgIGxldCBxID0gW3RoaXMuX3NvdXJjZV07XG4gICAgd2hpbGUgKHEubGVuZ3RoID4gMCkge1xuICAgICAgbGV0IHNyYyA9IHEuc2hpZnQoKTtcbiAgICAgIGZvciAobGV0IGl0ZW0gb2Ygc3JjISkge1xuICAgICAgICBxLnB1c2godGhpcy5fZm4oaXRlbSkpO1xuICAgICAgICB5aWVsZCBpdGVtO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEV4cGFuZHMgdGhlIHNlcXVlbmNlIGJ5IHJlY3Vyc2l2ZWx5IGFwcGx5aW5nIGEgc2VsZWN0b3IgZnVuY3Rpb24uXG4gKiBAcGFyYW0ge0l0ZXJhYmxlPFQ+fSBzb3VyY2UgU291cmNlIHNlcXVlbmNlLlxuICogQHBhcmFtIHtmdW5jdGlvbih2YWx1ZTogVCk6IEl0ZXJhYmxlPFQ+fSBzZWxlY3RvciBTZWxlY3RvciBmdW5jdGlvbiB0byByZXRyaWV2ZSB0aGUgbmV4dCBzZXF1ZW5jZSB0byBleHBhbmRcbiAqIEByZXR1cm4ge0l0ZXJhYmxlPFQ+fSBTZXF1ZW5jZSB3aXRoIHJlc3VsdHMgZnJvbSB0aGUgcmVjdXJzaXZlIGV4cGFuc2lvbiBvZiB0aGUgc291cmNlIHNlcXVlbmNlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhwYW5kPFRTb3VyY2U+KFxuICAgIHNvdXJjZTogSXRlcmFibGU8VFNvdXJjZT4sXG4gICAgc2VsZWN0b3I6ICh2YWx1ZTogVFNvdXJjZSkgPT4gSXRlcmFibGU8VFNvdXJjZT4pOiBJdGVyYWJsZVg8VFNvdXJjZT4ge1xuICByZXR1cm4gbmV3IEV4cGFuZEl0ZXJhYmxlPFRTb3VyY2U+KHNvdXJjZSxzZWxlY3Rvcik7XG59XG4iXX0=
