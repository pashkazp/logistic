Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var asynciterable_1 = require("../asynciterable");
var _sleep_1 = require("./_sleep");
var GenerateTimeAsyncIterable = (function (_super) {
    tslib_1.__extends(GenerateTimeAsyncIterable, _super);
    function GenerateTimeAsyncIterable(initialState, condition, iterate, resultSelector, timeSelector) {
        var _this = _super.call(this) || this;
        _this._initialState = initialState;
        _this._condition = condition;
        _this._iterate = iterate;
        _this._resultSelector = resultSelector;
        _this._timeSelector = timeSelector;
        return _this;
    }
    GenerateTimeAsyncIterable.prototype[Symbol.asyncIterator] = function () {
        return tslib_1.__asyncGenerator(this, arguments, function _a() {
            var i, _a;
            return tslib_1.__generator(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        i = this._initialState;
                        _b.label = 1;
                    case 1: return [4 /*yield*/, tslib_1.__await(this._condition(i))];
                    case 2:
                        if (!_b.sent()) return [3 /*break*/, 9];
                        _a = _sleep_1.sleep;
                        return [4 /*yield*/, tslib_1.__await(this._timeSelector(i))];
                    case 3: return [4 /*yield*/, tslib_1.__await.apply(void 0, [_a.apply(void 0, [_b.sent()])])];
                    case 4:
                        _b.sent();
                        return [4 /*yield*/, tslib_1.__await(this._resultSelector(i))];
                    case 5: return [4 /*yield*/, _b.sent()];
                    case 6:
                        _b.sent();
                        _b.label = 7;
                    case 7: return [4 /*yield*/, tslib_1.__await(this._iterate(i))];
                    case 8:
                        i = _b.sent();
                        return [3 /*break*/, 1];
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    return GenerateTimeAsyncIterable;
}(asynciterable_1.AsyncIterableX));
function generateTime(initialState, condition, iterate, resultSelector, timeSelector) {
    return new GenerateTimeAsyncIterable(initialState, condition, iterate, resultSelector, timeSelector);
}
exports.generateTime = generateTime;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzeW5jaXRlcmFibGUvZ2VuZXJhdGV0aW1lLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsa0RBQWtEO0FBQ2xELG1DQUFpQztBQUVqQztJQUF5RCxxREFBdUI7SUFPOUUsbUNBQ0ksWUFBb0IsRUFDcEIsU0FBd0QsRUFDeEQsT0FBb0QsRUFDcEQsY0FBNkQsRUFDN0QsWUFBeUQ7UUFMN0QsWUFNRSxpQkFBTyxTQU1SO1FBTEMsS0FBSSxDQUFDLGFBQWEsR0FBRyxZQUFZLENBQUM7UUFDbEMsS0FBSSxDQUFDLFVBQVUsR0FBRyxTQUFTLENBQUM7UUFDNUIsS0FBSSxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUM7UUFDeEIsS0FBSSxDQUFDLGVBQWUsR0FBRyxjQUFjLENBQUM7UUFDdEMsS0FBSSxDQUFDLGFBQWEsR0FBRyxZQUFZLENBQUM7O0lBQ3BDLENBQUM7SUFFTSxvQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQTdCOzs7Ozs7d0JBQ1csQ0FBQyxHQUFHLElBQUksQ0FBQyxhQUFhOzs0QkFBRSxxQ0FBTSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxHQUFBOzs2QkFBeEIsU0FBd0I7d0JBQ2pELEtBQUEsY0FBSyxDQUFBO3dCQUFDLHFDQUFNLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLEdBQUE7NEJBQXZDLG9EQUFNLGtCQUFNLFNBQTJCLEVBQUMsSUFBQTs7d0JBQXhDLFNBQXdDLENBQUM7d0JBQ25DLHFDQUFNLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLEdBQUE7NEJBQW5DLHFCQUFNLFNBQTZCLEVBQUE7O3dCQUFuQyxTQUFtQyxDQUFDOzs0QkFGeUIscUNBQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBQTs7d0JBQTFCLENBQUMsR0FBRyxTQUFzQixDQUFBOzs7Ozs7S0FJdEY7SUFDSCxnQ0FBQztBQUFELENBM0JBLEFBMkJDLENBM0J3RCw4QkFBYyxHQTJCdEU7QUFFRCxzQkFDSSxZQUFvQixFQUNwQixTQUF3RCxFQUN4RCxPQUFvRCxFQUNwRCxjQUE2RCxFQUM3RCxZQUF5RDtJQUMzRCxNQUFNLENBQUMsSUFBSSx5QkFBeUIsQ0FDbEMsWUFBWSxFQUNaLFNBQVMsRUFDVCxPQUFPLEVBQ1AsY0FBYyxFQUNkLFlBQVksQ0FBQyxDQUFDO0FBQ2xCLENBQUM7QUFaRCxvQ0FZQyIsImZpbGUiOiJhc3luY2l0ZXJhYmxlL2dlbmVyYXRldGltZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzeW5jSXRlcmFibGVYIH0gZnJvbSAnLi4vYXN5bmNpdGVyYWJsZSc7XG5pbXBvcnQgeyBzbGVlcCB9IGZyb20gJy4vX3NsZWVwJztcblxuY2xhc3MgR2VuZXJhdGVUaW1lQXN5bmNJdGVyYWJsZTxUU3RhdGUsIFRSZXN1bHQ+IGV4dGVuZHMgQXN5bmNJdGVyYWJsZVg8VFJlc3VsdD4ge1xuICBwcml2YXRlIF9pbml0aWFsU3RhdGU6IFRTdGF0ZTtcbiAgcHJpdmF0ZSBfY29uZGl0aW9uOiAodmFsdWU6IFRTdGF0ZSkgPT4gYm9vbGVhbiB8IFByb21pc2U8Ym9vbGVhbj47XG4gIHByaXZhdGUgX2l0ZXJhdGU6ICh2YWx1ZTogVFN0YXRlKSA9PiBUU3RhdGUgfCBQcm9taXNlPFRTdGF0ZT47XG4gIHByaXZhdGUgX3Jlc3VsdFNlbGVjdG9yOiAodmFsdWU6IFRTdGF0ZSkgPT4gVFJlc3VsdCB8IFByb21pc2U8VFJlc3VsdD47XG4gIHByaXZhdGUgX3RpbWVTZWxlY3RvcjogKHZhbHVlOiBUU3RhdGUpID0+IG51bWJlciB8IFByb21pc2U8bnVtYmVyPjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICAgIGluaXRpYWxTdGF0ZTogVFN0YXRlLFxuICAgICAgY29uZGl0aW9uOiAodmFsdWU6IFRTdGF0ZSkgPT4gYm9vbGVhbiB8IFByb21pc2U8Ym9vbGVhbj4sXG4gICAgICBpdGVyYXRlOiAodmFsdWU6IFRTdGF0ZSkgPT4gVFN0YXRlIHwgUHJvbWlzZTxUU3RhdGU+LFxuICAgICAgcmVzdWx0U2VsZWN0b3I6ICh2YWx1ZTogVFN0YXRlKSA9PiBUUmVzdWx0IHwgUHJvbWlzZTxUUmVzdWx0PixcbiAgICAgIHRpbWVTZWxlY3RvcjogKHZhbHVlOiBUU3RhdGUpID0+IG51bWJlciB8IFByb21pc2U8bnVtYmVyPikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5faW5pdGlhbFN0YXRlID0gaW5pdGlhbFN0YXRlO1xuICAgIHRoaXMuX2NvbmRpdGlvbiA9IGNvbmRpdGlvbjtcbiAgICB0aGlzLl9pdGVyYXRlID0gaXRlcmF0ZTtcbiAgICB0aGlzLl9yZXN1bHRTZWxlY3RvciA9IHJlc3VsdFNlbGVjdG9yO1xuICAgIHRoaXMuX3RpbWVTZWxlY3RvciA9IHRpbWVTZWxlY3RvcjtcbiAgfVxuXG4gIGFzeW5jICpbU3ltYm9sLmFzeW5jSXRlcmF0b3JdKCkge1xuICAgIGZvciAobGV0IGkgPSB0aGlzLl9pbml0aWFsU3RhdGU7IGF3YWl0IHRoaXMuX2NvbmRpdGlvbihpKTsgaSA9IGF3YWl0IHRoaXMuX2l0ZXJhdGUoaSkpIHtcbiAgICAgIGF3YWl0IHNsZWVwKGF3YWl0IHRoaXMuX3RpbWVTZWxlY3RvcihpKSk7XG4gICAgICB5aWVsZCBhd2FpdCB0aGlzLl9yZXN1bHRTZWxlY3RvcihpKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlVGltZTxUU3RhdGUsIFRSZXN1bHQ+KFxuICAgIGluaXRpYWxTdGF0ZTogVFN0YXRlLFxuICAgIGNvbmRpdGlvbjogKHZhbHVlOiBUU3RhdGUpID0+IGJvb2xlYW4gfCBQcm9taXNlPGJvb2xlYW4+LFxuICAgIGl0ZXJhdGU6ICh2YWx1ZTogVFN0YXRlKSA9PiBUU3RhdGUgfCBQcm9taXNlPFRTdGF0ZT4sXG4gICAgcmVzdWx0U2VsZWN0b3I6ICh2YWx1ZTogVFN0YXRlKSA9PiBUUmVzdWx0IHwgUHJvbWlzZTxUUmVzdWx0PixcbiAgICB0aW1lU2VsZWN0b3I6ICh2YWx1ZTogVFN0YXRlKSA9PiBudW1iZXIgfCBQcm9taXNlPG51bWJlcj4pOiBBc3luY0l0ZXJhYmxlWDxUUmVzdWx0PiB7XG4gIHJldHVybiBuZXcgR2VuZXJhdGVUaW1lQXN5bmNJdGVyYWJsZTxUU3RhdGUsIFRSZXN1bHQ+KFxuICAgIGluaXRpYWxTdGF0ZSxcbiAgICBjb25kaXRpb24sXG4gICAgaXRlcmF0ZSxcbiAgICByZXN1bHRTZWxlY3RvcixcbiAgICB0aW1lU2VsZWN0b3IpO1xufVxuIl19
