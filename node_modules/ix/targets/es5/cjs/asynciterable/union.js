Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var asynciterable_1 = require("../asynciterable");
var arrayindexof_1 = require("../internal/arrayindexof");
var comparer_1 = require("../internal/comparer");
var UnionAsyncIterable = (function (_super) {
    tslib_1.__extends(UnionAsyncIterable, _super);
    function UnionAsyncIterable(left, right, comparer) {
        var _this = _super.call(this) || this;
        _this._left = left;
        _this._right = right;
        _this._comparer = comparer;
        return _this;
    }
    UnionAsyncIterable.prototype[Symbol.asyncIterator] = function () {
        return tslib_1.__asyncGenerator(this, arguments, function _a() {
            var map, _a, _b, lItem, e_1_1, _c, _d, rItem, e_2_1, e_1, _e, e_2, _f;
            return tslib_1.__generator(this, function (_g) {
                switch (_g.label) {
                    case 0:
                        map = [];
                        _g.label = 1;
                    case 1:
                        _g.trys.push([1, 9, 10, 15]);
                        _a = tslib_1.__asyncValues(this._left);
                        _g.label = 2;
                    case 2: return [4 /*yield*/, tslib_1.__await(_a.next())];
                    case 3:
                        if (!(_b = _g.sent(), !_b.done)) return [3 /*break*/, 8];
                        return [4 /*yield*/, tslib_1.__await(_b.value)];
                    case 4:
                        lItem = _g.sent();
                        return [4 /*yield*/, tslib_1.__await(arrayindexof_1.arrayIndexOfAsync(map, lItem, this._comparer))];
                    case 5:
                        if (!((_g.sent()) === -1)) return [3 /*break*/, 7];
                        map.push(lItem);
                        return [4 /*yield*/, lItem];
                    case 6:
                        _g.sent();
                        _g.label = 7;
                    case 7: return [3 /*break*/, 2];
                    case 8: return [3 /*break*/, 15];
                    case 9:
                        e_1_1 = _g.sent();
                        e_1 = { error: e_1_1 };
                        return [3 /*break*/, 15];
                    case 10:
                        _g.trys.push([10, , 13, 14]);
                        if (!(_b && !_b.done && (_e = _a.return))) return [3 /*break*/, 12];
                        return [4 /*yield*/, tslib_1.__await(_e.call(_a))];
                    case 11:
                        _g.sent();
                        _g.label = 12;
                    case 12: return [3 /*break*/, 14];
                    case 13:
                        if (e_1) throw e_1.error;
                        return [7 /*endfinally*/];
                    case 14: return [7 /*endfinally*/];
                    case 15:
                        _g.trys.push([15, 23, 24, 29]);
                        _c = tslib_1.__asyncValues(this._right);
                        _g.label = 16;
                    case 16: return [4 /*yield*/, tslib_1.__await(_c.next())];
                    case 17:
                        if (!(_d = _g.sent(), !_d.done)) return [3 /*break*/, 22];
                        return [4 /*yield*/, tslib_1.__await(_d.value)];
                    case 18:
                        rItem = _g.sent();
                        return [4 /*yield*/, tslib_1.__await(arrayindexof_1.arrayIndexOfAsync(map, rItem, this._comparer))];
                    case 19:
                        if (!((_g.sent()) === -1)) return [3 /*break*/, 21];
                        map.push(rItem);
                        return [4 /*yield*/, rItem];
                    case 20:
                        _g.sent();
                        _g.label = 21;
                    case 21: return [3 /*break*/, 16];
                    case 22: return [3 /*break*/, 29];
                    case 23:
                        e_2_1 = _g.sent();
                        e_2 = { error: e_2_1 };
                        return [3 /*break*/, 29];
                    case 24:
                        _g.trys.push([24, , 27, 28]);
                        if (!(_d && !_d.done && (_f = _c.return))) return [3 /*break*/, 26];
                        return [4 /*yield*/, tslib_1.__await(_f.call(_c))];
                    case 25:
                        _g.sent();
                        _g.label = 26;
                    case 26: return [3 /*break*/, 28];
                    case 27:
                        if (e_2) throw e_2.error;
                        return [7 /*endfinally*/];
                    case 28: return [7 /*endfinally*/];
                    case 29: return [2 /*return*/];
                }
            });
        });
    };
    return UnionAsyncIterable;
}(asynciterable_1.AsyncIterableX));
function union(left, right, comparer) {
    if (comparer === void 0) { comparer = comparer_1.comparerAsync; }
    return new UnionAsyncIterable(left, right, comparer);
}
exports.union = union;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzeW5jaXRlcmFibGUvdW5pb24udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxrREFBa0Q7QUFDbEQseURBQTZEO0FBQzdELGlEQUFxRDtBQUVyRDtJQUEwQyw4Q0FBdUI7SUFLL0QsNEJBQ0ksSUFBNEIsRUFDNUIsS0FBNkIsRUFDN0IsUUFBZ0U7UUFIcEUsWUFJRSxpQkFBTyxTQUlSO1FBSEMsS0FBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7UUFDbEIsS0FBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7UUFDcEIsS0FBSSxDQUFDLFNBQVMsR0FBRyxRQUFRLENBQUM7O0lBQzVCLENBQUM7SUFFTSw2QkFBQyxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQTdCOzs7Ozs7d0JBQ00sR0FBRyxHQUFHLEVBQUUsQ0FBQzs7Ozt3QkFDVyxLQUFBLHNCQUFBLElBQUksQ0FBQyxLQUFLLENBQUE7Ozs7Ozs7d0JBQW5CLEtBQUssWUFBQTt3QkFDZCxxQ0FBTSxnQ0FBaUIsQ0FBQyxHQUFHLEVBQUUsS0FBSyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBQTs7NkJBQW5ELENBQUEsQ0FBQSxTQUFtRCxNQUFLLENBQUMsQ0FBQyxDQUFBLEVBQTFELHdCQUEwRDt3QkFDNUQsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQzt3QkFDaEIscUJBQU0sS0FBSyxFQUFBOzt3QkFBWCxTQUFXLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7d0JBSVEsS0FBQSxzQkFBQSxJQUFJLENBQUMsTUFBTSxDQUFBOzs7Ozs7O3dCQUFwQixLQUFLLFlBQUE7d0JBQ2QscUNBQU0sZ0NBQWlCLENBQUMsR0FBRyxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUE7OzZCQUFuRCxDQUFBLENBQUEsU0FBbUQsTUFBSyxDQUFDLENBQUMsQ0FBQSxFQUExRCx5QkFBMEQ7d0JBQzVELEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7d0JBQ2hCLHFCQUFNLEtBQUssRUFBQTs7d0JBQVgsU0FBVyxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7S0FHakI7SUFDSCx5QkFBQztBQUFELENBL0JBLEFBK0JDLENBL0J5Qyw4QkFBYyxHQStCdkQ7QUFFRCxlQUNJLElBQTRCLEVBQzVCLEtBQTZCLEVBQzdCLFFBQWdGO0lBQWhGLHlCQUFBLEVBQUEsV0FBbUUsd0JBQWE7SUFDbEYsTUFBTSxDQUFDLElBQUksa0JBQWtCLENBQVUsSUFBSSxFQUFFLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQztBQUNoRSxDQUFDO0FBTEQsc0JBS0MiLCJmaWxlIjoiYXN5bmNpdGVyYWJsZS91bmlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFzeW5jSXRlcmFibGVYIH0gZnJvbSAnLi4vYXN5bmNpdGVyYWJsZSc7XG5pbXBvcnQgeyBhcnJheUluZGV4T2ZBc3luYyB9IGZyb20gJy4uL2ludGVybmFsL2FycmF5aW5kZXhvZic7XG5pbXBvcnQgeyBjb21wYXJlckFzeW5jIH0gZnJvbSAnLi4vaW50ZXJuYWwvY29tcGFyZXInO1xuXG5jbGFzcyBVbmlvbkFzeW5jSXRlcmFibGU8VFNvdXJjZT4gZXh0ZW5kcyBBc3luY0l0ZXJhYmxlWDxUU291cmNlPiB7XG4gIHByaXZhdGUgX2xlZnQ6IEFzeW5jSXRlcmFibGU8VFNvdXJjZT47XG4gIHByaXZhdGUgX3JpZ2h0OiBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+O1xuICBwcml2YXRlIF9jb21wYXJlcjogKHg6IFRTb3VyY2UsIHk6IFRTb3VyY2UpID0+IGJvb2xlYW4gfCBQcm9taXNlPGJvb2xlYW4+O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgICAgbGVmdDogQXN5bmNJdGVyYWJsZTxUU291cmNlPixcbiAgICAgIHJpZ2h0OiBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+LFxuICAgICAgY29tcGFyZXI6ICh4OiBUU291cmNlLCB5OiBUU291cmNlKSA9PiBib29sZWFuIHwgUHJvbWlzZTxib29sZWFuPikge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5fbGVmdCA9IGxlZnQ7XG4gICAgdGhpcy5fcmlnaHQgPSByaWdodDtcbiAgICB0aGlzLl9jb21wYXJlciA9IGNvbXBhcmVyO1xuICB9XG5cbiAgYXN5bmMgKltTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKSB7XG4gICAgbGV0IG1hcCA9IFtdO1xuICAgIGZvciBhd2FpdCAobGV0IGxJdGVtIG9mIHRoaXMuX2xlZnQpIHtcbiAgICAgIGlmIChhd2FpdCBhcnJheUluZGV4T2ZBc3luYyhtYXAsIGxJdGVtLCB0aGlzLl9jb21wYXJlcikgPT09IC0xKSB7XG4gICAgICAgIG1hcC5wdXNoKGxJdGVtKTtcbiAgICAgICAgeWllbGQgbEl0ZW07XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIGF3YWl0IChsZXQgckl0ZW0gb2YgdGhpcy5fcmlnaHQpIHtcbiAgICAgIGlmIChhd2FpdCBhcnJheUluZGV4T2ZBc3luYyhtYXAsIHJJdGVtLCB0aGlzLl9jb21wYXJlcikgPT09IC0xKSB7XG4gICAgICAgIG1hcC5wdXNoKHJJdGVtKTtcbiAgICAgICAgeWllbGQgckl0ZW07XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bmlvbjxUU291cmNlPihcbiAgICBsZWZ0OiBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+LFxuICAgIHJpZ2h0OiBBc3luY0l0ZXJhYmxlPFRTb3VyY2U+LFxuICAgIGNvbXBhcmVyOiAoeDogVFNvdXJjZSwgeTogVFNvdXJjZSkgPT4gYm9vbGVhbiB8IFByb21pc2U8Ym9vbGVhbj4gPSBjb21wYXJlckFzeW5jKTogQXN5bmNJdGVyYWJsZVg8VFNvdXJjZT4ge1xuICByZXR1cm4gbmV3IFVuaW9uQXN5bmNJdGVyYWJsZTxUU291cmNlPihsZWZ0LCByaWdodCwgY29tcGFyZXIpO1xufVxuIl19
