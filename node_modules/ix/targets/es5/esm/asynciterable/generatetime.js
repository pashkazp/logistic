import * as tslib_1 from "tslib";
import { AsyncIterableX } from '../asynciterable';
import { sleep } from './_sleep';
var GenerateTimeAsyncIterable = (function (_super) {
    tslib_1.__extends(GenerateTimeAsyncIterable, _super);
    function GenerateTimeAsyncIterable(initialState, condition, iterate, resultSelector, timeSelector) {
        var _this = _super.call(this) || this;
        _this._initialState = initialState;
        _this._condition = condition;
        _this._iterate = iterate;
        _this._resultSelector = resultSelector;
        _this._timeSelector = timeSelector;
        return _this;
    }
    GenerateTimeAsyncIterable.prototype[Symbol.asyncIterator] = function () {
        return tslib_1.__asyncGenerator(this, arguments, function _a() {
            var i, _a;
            return tslib_1.__generator(this, function (_b) {
                switch (_b.label) {
                    case 0:
                        i = this._initialState;
                        _b.label = 1;
                    case 1: return [4 /*yield*/, tslib_1.__await(this._condition(i))];
                    case 2:
                        if (!_b.sent()) return [3 /*break*/, 9];
                        _a = sleep;
                        return [4 /*yield*/, tslib_1.__await(this._timeSelector(i))];
                    case 3: return [4 /*yield*/, tslib_1.__await.apply(void 0, [_a.apply(void 0, [_b.sent()])])];
                    case 4:
                        _b.sent();
                        return [4 /*yield*/, tslib_1.__await(this._resultSelector(i))];
                    case 5: return [4 /*yield*/, _b.sent()];
                    case 6:
                        _b.sent();
                        _b.label = 7;
                    case 7: return [4 /*yield*/, tslib_1.__await(this._iterate(i))];
                    case 8:
                        i = _b.sent();
                        return [3 /*break*/, 1];
                    case 9: return [2 /*return*/];
                }
            });
        });
    };
    return GenerateTimeAsyncIterable;
}(AsyncIterableX));
export function generateTime(initialState, condition, iterate, resultSelector, timeSelector) {
    return new GenerateTimeAsyncIterable(initialState, condition, iterate, resultSelector, timeSelector);
}

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzeW5jaXRlcmFibGUvZ2VuZXJhdGV0aW1lLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDbEQsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUVqQztJQUF5RCxxREFBdUI7SUFPOUUsbUNBQ0ksWUFBb0IsRUFDcEIsU0FBd0QsRUFDeEQsT0FBb0QsRUFDcEQsY0FBNkQsRUFDN0QsWUFBeUQ7UUFMN0QsWUFNRSxpQkFBTyxTQU1SO1FBTEMsS0FBSSxDQUFDLGFBQWEsR0FBRyxZQUFZLENBQUM7UUFDbEMsS0FBSSxDQUFDLFVBQVUsR0FBRyxTQUFTLENBQUM7UUFDNUIsS0FBSSxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUM7UUFDeEIsS0FBSSxDQUFDLGVBQWUsR0FBRyxjQUFjLENBQUM7UUFDdEMsS0FBSSxDQUFDLGFBQWEsR0FBRyxZQUFZLENBQUM7O0lBQ3BDLENBQUM7SUFFTSxvQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLEdBQTdCOzs7Ozs7d0JBQ1csQ0FBQyxHQUFHLElBQUksQ0FBQyxhQUFhOzs0QkFBRSxxQ0FBTSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxHQUFBOzs2QkFBeEIsU0FBd0I7d0JBQ2pELEtBQUEsS0FBSyxDQUFBO3dCQUFDLHFDQUFNLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLEdBQUE7NEJBQXZDLG9EQUFNLGtCQUFNLFNBQTJCLEVBQUMsSUFBQTs7d0JBQXhDLFNBQXdDLENBQUM7d0JBQ25DLHFDQUFNLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLEdBQUE7NEJBQW5DLHFCQUFNLFNBQTZCLEVBQUE7O3dCQUFuQyxTQUFtQyxDQUFDOzs0QkFGeUIscUNBQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBQTs7d0JBQTFCLENBQUMsR0FBRyxTQUFzQixDQUFBOzs7Ozs7S0FJdEY7SUFDSCxnQ0FBQztBQUFELENBM0JBLEFBMkJDLENBM0J3RCxjQUFjLEdBMkJ0RTtBQUVELE1BQU0sdUJBQ0YsWUFBb0IsRUFDcEIsU0FBd0QsRUFDeEQsT0FBb0QsRUFDcEQsY0FBNkQsRUFDN0QsWUFBeUQ7SUFDM0QsTUFBTSxDQUFDLElBQUkseUJBQXlCLENBQ2xDLFlBQVksRUFDWixTQUFTLEVBQ1QsT0FBTyxFQUNQLGNBQWMsRUFDZCxZQUFZLENBQUMsQ0FBQztBQUNsQixDQUFDIiwiZmlsZSI6ImFzeW5jaXRlcmFibGUvZ2VuZXJhdGV0aW1lLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXN5bmNJdGVyYWJsZVggfSBmcm9tICcuLi9hc3luY2l0ZXJhYmxlJztcbmltcG9ydCB7IHNsZWVwIH0gZnJvbSAnLi9fc2xlZXAnO1xuXG5jbGFzcyBHZW5lcmF0ZVRpbWVBc3luY0l0ZXJhYmxlPFRTdGF0ZSwgVFJlc3VsdD4gZXh0ZW5kcyBBc3luY0l0ZXJhYmxlWDxUUmVzdWx0PiB7XG4gIHByaXZhdGUgX2luaXRpYWxTdGF0ZTogVFN0YXRlO1xuICBwcml2YXRlIF9jb25kaXRpb246ICh2YWx1ZTogVFN0YXRlKSA9PiBib29sZWFuIHwgUHJvbWlzZTxib29sZWFuPjtcbiAgcHJpdmF0ZSBfaXRlcmF0ZTogKHZhbHVlOiBUU3RhdGUpID0+IFRTdGF0ZSB8IFByb21pc2U8VFN0YXRlPjtcbiAgcHJpdmF0ZSBfcmVzdWx0U2VsZWN0b3I6ICh2YWx1ZTogVFN0YXRlKSA9PiBUUmVzdWx0IHwgUHJvbWlzZTxUUmVzdWx0PjtcbiAgcHJpdmF0ZSBfdGltZVNlbGVjdG9yOiAodmFsdWU6IFRTdGF0ZSkgPT4gbnVtYmVyIHwgUHJvbWlzZTxudW1iZXI+O1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgICAgaW5pdGlhbFN0YXRlOiBUU3RhdGUsXG4gICAgICBjb25kaXRpb246ICh2YWx1ZTogVFN0YXRlKSA9PiBib29sZWFuIHwgUHJvbWlzZTxib29sZWFuPixcbiAgICAgIGl0ZXJhdGU6ICh2YWx1ZTogVFN0YXRlKSA9PiBUU3RhdGUgfCBQcm9taXNlPFRTdGF0ZT4sXG4gICAgICByZXN1bHRTZWxlY3RvcjogKHZhbHVlOiBUU3RhdGUpID0+IFRSZXN1bHQgfCBQcm9taXNlPFRSZXN1bHQ+LFxuICAgICAgdGltZVNlbGVjdG9yOiAodmFsdWU6IFRTdGF0ZSkgPT4gbnVtYmVyIHwgUHJvbWlzZTxudW1iZXI+KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9pbml0aWFsU3RhdGUgPSBpbml0aWFsU3RhdGU7XG4gICAgdGhpcy5fY29uZGl0aW9uID0gY29uZGl0aW9uO1xuICAgIHRoaXMuX2l0ZXJhdGUgPSBpdGVyYXRlO1xuICAgIHRoaXMuX3Jlc3VsdFNlbGVjdG9yID0gcmVzdWx0U2VsZWN0b3I7XG4gICAgdGhpcy5fdGltZVNlbGVjdG9yID0gdGltZVNlbGVjdG9yO1xuICB9XG5cbiAgYXN5bmMgKltTeW1ib2wuYXN5bmNJdGVyYXRvcl0oKSB7XG4gICAgZm9yIChsZXQgaSA9IHRoaXMuX2luaXRpYWxTdGF0ZTsgYXdhaXQgdGhpcy5fY29uZGl0aW9uKGkpOyBpID0gYXdhaXQgdGhpcy5faXRlcmF0ZShpKSkge1xuICAgICAgYXdhaXQgc2xlZXAoYXdhaXQgdGhpcy5fdGltZVNlbGVjdG9yKGkpKTtcbiAgICAgIHlpZWxkIGF3YWl0IHRoaXMuX3Jlc3VsdFNlbGVjdG9yKGkpO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVUaW1lPFRTdGF0ZSwgVFJlc3VsdD4oXG4gICAgaW5pdGlhbFN0YXRlOiBUU3RhdGUsXG4gICAgY29uZGl0aW9uOiAodmFsdWU6IFRTdGF0ZSkgPT4gYm9vbGVhbiB8IFByb21pc2U8Ym9vbGVhbj4sXG4gICAgaXRlcmF0ZTogKHZhbHVlOiBUU3RhdGUpID0+IFRTdGF0ZSB8IFByb21pc2U8VFN0YXRlPixcbiAgICByZXN1bHRTZWxlY3RvcjogKHZhbHVlOiBUU3RhdGUpID0+IFRSZXN1bHQgfCBQcm9taXNlPFRSZXN1bHQ+LFxuICAgIHRpbWVTZWxlY3RvcjogKHZhbHVlOiBUU3RhdGUpID0+IG51bWJlciB8IFByb21pc2U8bnVtYmVyPik6IEFzeW5jSXRlcmFibGVYPFRSZXN1bHQ+IHtcbiAgcmV0dXJuIG5ldyBHZW5lcmF0ZVRpbWVBc3luY0l0ZXJhYmxlPFRTdGF0ZSwgVFJlc3VsdD4oXG4gICAgaW5pdGlhbFN0YXRlLFxuICAgIGNvbmRpdGlvbixcbiAgICBpdGVyYXRlLFxuICAgIHJlc3VsdFNlbGVjdG9yLFxuICAgIHRpbWVTZWxlY3Rvcik7XG59XG4iXX0=
